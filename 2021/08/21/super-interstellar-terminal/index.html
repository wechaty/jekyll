<!DOCTYPE html>
<html lang="en">
<head>
    <!-- https://github.com/t-richards/jekyll-google-tag-manager -->
    <!-- Begin Jekyll GTM tag v1.0.3 -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-PD2PL84');</script>
<!-- End Jekyll GTM tag v1.0.3 -->


    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">

    

    <title>
      <x 世纪星际终端>基于 wechaty 的 AR+LBS 漂流瓶轻社交游戏 | Wechaty
    </title>

    <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>基于 wechaty 的 AR+LBS 漂流瓶轻社交游戏 | Wechaty</title>
<meta name="generator" content="Jekyll v4.4.1" />
<meta property="og:title" content="基于 wechaty 的 AR+LBS 漂流瓶轻社交游戏" />
<meta name="author" content="kevinfu1717" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="基于微信聊天的 结合增强现实技术（AR）+LBS(暂时基于图像） 的星际漂流瓶 的轻社交游戏。重新认识你身边的世界，或许我们早已与外星生命共同生活着。" />
<meta property="og:description" content="基于微信聊天的 结合增强现实技术（AR）+LBS(暂时基于图像） 的星际漂流瓶 的轻社交游戏。重新认识你身边的世界，或许我们早已与外星生命共同生活着。" />
<link rel="canonical" href="https://wechaty.js.org/2021/08/21/super-interstellar-terminal/" />
<meta property="og:url" content="https://wechaty.js.org/2021/08/21/super-interstellar-terminal/" />
<meta property="og:site_name" content="Wechaty" />
<meta property="og:image" content="https://wechaty.js.org/assets/2021/08-super-interstellar-terminal/title.webp" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2021-08-21T00:00:00+00:00" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="twitter:image" content="https://wechaty.js.org/assets/2021/08-super-interstellar-terminal/title.webp" />
<meta property="twitter:title" content="基于 wechaty 的 AR+LBS 漂流瓶轻社交游戏" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"kevinfu1717"},"dateModified":"2021-08-21T00:00:00+00:00","datePublished":"2021-08-21T00:00:00+00:00","description":"基于微信聊天的 结合增强现实技术（AR）+LBS(暂时基于图像） 的星际漂流瓶 的轻社交游戏。重新认识你身边的世界，或许我们早已与外星生命共同生活着。","headline":"基于 wechaty 的 AR+LBS 漂流瓶轻社交游戏","image":"https://wechaty.js.org/assets/2021/08-super-interstellar-terminal/title.webp","mainEntityOfPage":{"@type":"WebPage","@id":"https://wechaty.js.org/2021/08/21/super-interstellar-terminal/"},"publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"https://wechaty.js.org/assets/images/logo.png"},"name":"kevinfu1717"},"url":"https://wechaty.js.org/2021/08/21/super-interstellar-terminal/"}</script>
<!-- End Jekyll SEO tag -->


    <link rel="shortcut icon" type="image/x-icon" href="/assets/images/favicon.ico">

    <link rel="manifest" href="/manifest.json">

    <!-- Font Awesome Icons -->
    <link rel="stylesheet" href="https://s3.pstatp.com/cdn/expire-1-M/font-awesome/5.3.1/css/all.css" crossorigin="anonymous">

    <!-- Google Fonts in China Thanks @crossly @sidny -->
    <link href="https://fonts.loli.net/css?family=Lora" rel="stylesheet">

    <!-- Bootstrap Modified -->
    <link rel="stylesheet" href="/assets/css/main.css">

    <!-- Theme Stylesheet -->
    <link rel="stylesheet" href="/assets/css/theme.css">

    <!-- Highlight Stylesheet -->
    <link rel="stylesheet" href="/assets/css/highlight.css">

    <!-- Jquery on header to make sure everything works, the rest  of the scripts in footer for fast loading -->
    <script
    src="https://s0.pstatp.com/cdn/expire-1-M/jquery/3.3.1/jquery.min.js"
    integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
    crossorigin="anonymous"></script>

    




</head>

<body class="">
    <!-- https://github.com/t-richards/jekyll-google-tag-manager -->
    <!-- Begin Jekyll GTM tag v1.0.3 (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-PD2PL84"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Jekyll GTM tag v1.0.3 (noscript) -->


    <!-- Navbar -->
    <nav id="MagicMenu" class="topnav navbar navbar-expand-lg navbar-light bg-white fixed-top">
    <div class="container">
        <a class="navbar-brand" href="/"><strong>Wechaty</strong></a>
        <button class="navbar-toggler collapsed" type="button" data-toggle="collapse" data-target="#navbarColor02" aria-controls="navbarColor02" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
        </button>
        <div class="navbar-collapse collapse" id="navbarColor02">
            <ul class="navbar-nav mr-auto d-flex align-items-center">
               <!--  Replace menu links here -->

<li class="nav-item">
  <a class="nav-link" href="/news/">News</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="/blog/">Blog</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="https://ship.fail" target="_blank">Ship.Fail</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="https://preangel.ai" target="_blank">PreAngel.AI</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="/docs/">Docs</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="/contributors/">Contributors</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="https://github.com/wechaty/PMC#wechaty-committers" target="_blank">Talks</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="https://github.com/wechaty/wechaty#readme" target="_blank">GitHub</a>
</li>


            </ul>
            <ul class="navbar-nav ml-auto d-flex align-items-center">
                <li class="nav-item">
                  <a class="nav-link" href="/search/">Search</a>
                </li>
            </ul>
        </div>
    </div>
    </nav>

  <!-- Search results moved to a dedicated /search page -->

    <!-- Content -->
    <main role="main" class="site-content">
        

<div class="container">
<div class="jumbotron jumbotron-fluid mb-3 pl-0 pt-0 pb-0 bg-white position-relative">
		<div class="h-100 tofront">
			<div class="row  justify-content-between ">
				<div class=" col-md-6  pr-0 pr-md-4 pt-4 pb-4 align-self-center">
					<p class="text-uppercase font-weight-bold">
            <span class="catlist">

            
              <a class="sscroll text-danger" href="/categories.html#article">article</a><span class="sep">, </span>
            

            </span>
					</p>
					<h1 class="display-4 mb-4 article-headline"><x 世纪星际终端>基于 wechaty 的 AR+LBS 漂流瓶轻社交游戏</h1>
					<div class="d-flex align-items-center">
                        
                          <a href="/contributors/kevinfu1717">
                            <img class="rounded-circle" src="/assets/contributors/kevinfu1717/avatar.webp" alt="kevinfu1717" width="70"/>
                          </a>
                        
						<small class="ml-3"> <a href="/contributors/kevinfu1717">kevinfu1717</a> <span><a target="_blank" href="" class="btn btn-outline-success btn-sm btn-round ml-1">Follow</a></span>
                            <span class="text-muted d-block mt-1">Aug 21, 2021 · <span class="reading-time">
  
  
    11 mins read
  
</span>
</span>
						</small>
					</div>
				</div>
                
				<div class="col-md-6 pr-0 align-self-center">
					<img class="rounded" src="/assets/2021/08-super-interstellar-terminal/title.webp" alt="<x 世纪星际终端>基于 wechaty 的 AR+LBS 漂流瓶轻社交游戏">
				</div>
                
			</div>
		</div>
	</div>
</div>





<div class="container-lg pt-4 pb-4">
	<div class="row justify-content-center">

    <!-- Share -->
<div class="col-lg-2 pr-4 mb-5 col-md-12">
  <div class="sticky-top sticky-top-offset text-center">
    <div class="text-muted">
    </div>
    <div class="share d-inline-block">
      <!-- AddToAny BEGIN -->
      <div class="a2a_kit a2a_kit_size_32 a2a_default_style">
        <img id="qrcode" title="Wechat"
          src="/assets/contributors/wechaty/icon.png"
          width="64" height="64"
        />
        <a class="a2a_button_twitter" title='Twitter'></a>
        <a class="a2a_button_linkedin" title='LinkedIn'></a>
        <a class="a2a_button_facebook" title='FaceBook'></a>
        <a class="a2a_dd" href="https://www.addtoany.com/share"></a>
      </div>
      <script async src="https://static.addtoany.com/menu/page.js"></script>
      <!-- AddToAny END -->
    </div>
  </div>
</div>

<script>
  var href = document.location.href
  var url = 'https://api.qrserver.com/v1/create-qr-code/?data='
            + href
            + '&size=512x512'
  var img = document.getElementById('qrcode')

  img.src=encodeURI(url)
</script>


		<div class="col-md-12 col-lg-8">

      <!-- Article -->
			<article class="article-post">
			<p>基于<strong>微信聊天的 结合增强现实技术（AR）+LBS(暂时基于图像）</strong> 的<strong>星际漂流瓶</strong> 的轻社交游戏。重新认识你身边的世界，或许我们早已与外星生命共同生活着。</p>

<h2 id="a-项目介绍">A. 项目介绍</h2>

<h3 id="a1-项目模块">A.1 项目模块</h3>

<blockquote>
  <p>项目由下面的模块组成，每个模块都可以单独使用，也可组合使用，如：直接按需就调用图像生成外星人、外星生物、外星植物、外星建筑</p>
</blockquote>

<table>
  <thead>
    <tr>
      <th>简要</th>
      <th>具体描述</th>
      <th>项目中的代码及模型</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>1.基于 LSGAN 的外星生物生成</strong>，利用爬虫与 GAN 生成我们想要的东西的过程</td>
      <td>请跳转到本页中的 C.1</td>
      <td>Train.zip</td>
    </tr>
    <tr>
      <td><strong>2.快速调用PaddleSeg的cityscapes模型</strong>，进行18类常见物体的分割</td>
      <td>请跳转到本页中的 C.2</td>
      <td>CityscapesModule.py +PetModel文件夹</td>
    </tr>
    <tr>
      <td><strong>3.OpenCV的seamlessClone实现图像融合</strong>，呈现各种AR效果,遮挡关系等</td>
      <td>请跳转到本页中的 C.3</td>
      <td>alienPetModule.py</td>
    </tr>
    <tr>
      <td><strong>4.外星人换脸</strong>，外星人脸与地球人脸融合效果的优化</td>
      <td>请跳转到本页中的 C.4</td>
      <td>alienHeadModule.py</td>
    </tr>
    <tr>
      <td><strong>5.YUV颜色空间实现颜色图案迁移</strong>，基于CV技术生成外星植物</td>
      <td>请跳转到本页中的 C.5</td>
      <td>vegetateModule.py</td>
    </tr>
    <tr>
      <td><strong>6.PaddleHub的msgnet实现图像迁移</strong>，基于深度学习生成类流沙或沙画效果</td>
      <td>请跳转到本页中的 C.6</td>
      <td>sandModule.py + msgnet文件夹</td>
    </tr>
    <tr>
      <td><strong>7.Wechaty漂流瓶游戏</strong>，微信漂流瓶及通过开发者模式控制整个流程</td>
      <td>请跳转到本页中的 D</td>
      <td>bot文件夹</td>
    </tr>
  </tbody>
</table>

<p><img src="/assets/2021/08-super-interstellar-terminal/4front.webp" alt="4front" /></p>

<h3 id="a2-太空漂流信息">A.2 太空漂流信息</h3>

<blockquote>
  <p><strong>你可能收到来自一个未知星域发过来的漂流瓶，你也可以把你想抒发的情感发向星际中</strong></p>
</blockquote>

<ul>
  <li>
    <p>嗨，别来无恙啊，此刻的你是否有些孤独，别怕，此时此刻，在浩瀚宇宙中，总有与你相似的灵魂，你们或许来自不同的星球，有着不同的文明，但你们仍然可以通过太空漂流瓶去表达内心的情感，快来开启你的太空漂流瓶之旅吧。</p>
  </li>
  <li>
    <p>用户可以在加本官方微信好友后，向本官方微信发出包含文本与图片的漂流瓶。也可以主动接收漂流瓶。</p>
  </li>
  <li>
    <p>甚至，在一个你意想不到的时刻会收到想象之外的漂流瓶信息。发送与接收漂流瓶都可以提升等级噢！</p>
  </li>
</ul>

<h3 id="a3-增强现实技术ar位置服务lbs的游戏">A.3 增强现实技术（AR）+位置服务（LBS）的游戏</h3>

<blockquote>
  <p><strong>接收漂流瓶任务，或主动出击，寻找身边潜藏的外星人、外星生物（宠物）、外星植物、外星建筑</strong></p>
</blockquote>

<ul>
  <li>
    <p>基于微信聊天中的图片及文本聊天。通过文本接受到任务或主动触发。</p>
  </li>
  <li>
    <p>可能是让用户帮忙寻找它丢失的某个外星宠物（外星生物），或者帮它找到急需用于治疗的外星植物，也可能是让你帮忙找到正在被通缉的外星人囚犯。</p>
  </li>
</ul>

<h3 id="a4-体验视频建议全屏观看">A.4 体验视频：（建议全屏观看）</h3>

<div style="
    position: relative;
    padding-bottom: 70%;
    padding-top:30px;
    height:0;
    overflow:hidden;
">
  <iframe src="https://player.bilibili.com/player.html?bvid=BV1hL411E79M&amp;high_quality=1" allowfullscreen="" webkitallowfullscreen="" frameborder="0" style="
      position: absolute;
      top:0;
      left:0;
      width:100%;
      height:100%;
    ">
</iframe>

</div>

<ul>
  <li>
    <p><strong>欢迎小伙伴推荐地点及地点图片或直接加入本项目，可以先star或Fork跟踪更新进度</strong></p>

    <p>github地址：<a href="https://github.com/kevinfu1717/SuperInterstellarTerminal">https://github.com/kevinfu1717/SuperInterstellarTerminal</a></p>
  </li>
  <li>
    <p><strong>扫码加群，按群公告操作即可体验</strong>      <img src="/assets/2021/08-super-interstellar-terminal/qr-code.webp" alt="qr-code" /></p>
  </li>
</ul>

<h2 id="b-故事背景">B. 故事背景</h2>

<ul>
  <li>
    <p><strong>地球并不只是人类的天下，其实有数万名外星人及其外星低等生物生活在我们当中，他们有的因为母星被毁有的因为星际战乱而选择到地球避难。</strong></p>
  </li>
  <li>
    <p><strong>银河星际移民局则管理并协调着他们在地球的生活。借助超高级科技，他们隐藏原来的外观，装扮成是普通地球人，我们根本分辨不出来，说不定，站在你旁边的就是一位外星友人。</strong></p>
  </li>
  <li>
    <p><strong>同时，他们也带来了外星的低等生物及外星植物，通过超科技把他们隐藏起来，装扮成地球物种或我们完全看不到。</strong></p>

    <p><img src="/assets/2021/08-super-interstellar-terminal/bg.webp" alt="bg" /></p>
  </li>
</ul>

<h2 id="c-项目中的技术功能介绍">C. 项目中的技术功能介绍</h2>

<h3 id="c1-ai寻找你身边的外星生物">C.1 AI寻找你身边的外星生物</h3>

<h4 id="建立外星人图鉴让我们看一下ai预测的外星人形象是怎样的">建立外星人图鉴，让我们看一下AI预测的外星人形象是怎样的</h4>

<p><strong>先看一下AI预测的外星生物矢量图：</strong></p>

<p><img src="/assets/2021/08-super-interstellar-terminal/pets.webp" alt="pets" /></p>

<h4 id="a-训练素材">a. 训练素材</h4>

<ul>
  <li>
    <p>从百度爬取“外星人”的图片，但因为外星人搜出来的图太杂乱。所以改变思路，用关键词“外星人 矢量”来进行搜索爬取。搜出来的外星人图片相对没那么杂乱。勉强可以用来训练。勉强是有1/5左右是白底，有1/5左右是PS中那种透明图的格子底图或水印的，有1/5是背景各种颜色的图，还有1/5是多个外星元素组成的图。大概数据见下图：</p>

    <p><img src="/assets/2021/08-super-interstellar-terminal/pets2.webp" alt="pets2" /></p>
  </li>
</ul>

<h4 id="b-数据处理与增广">b. 数据处理与增广</h4>

<ul>
  <li>尝试过用midars模型或CV来提取单个外星生物，但效果都不是很好。所以，最终只使用水平翻转，增加了一倍的数量。尽管可以爬取来增加这个数量，但越到后面，爬取的图片质量越差。所以还是通过水平翻转来处理。</li>
</ul>

<h4 id="c-模型">c. 模型</h4>

<ul>
  <li>
    <p>训练文件：见项目中 Train压缩包下 <code class="language-plaintext highlighter-rouge">TrainAlienPet.ipynb</code></p>
  </li>
  <li>
    <p>模型文件：见项目中 Train压缩包下 <code class="language-plaintext highlighter-rouge">generator0725.params</code></p>
  </li>
  <li>
    <p>搜索了一下GAN的模型，结合可训练性与生成效果，选择了LSGAN。基于项目aistudio上“独楼望天涯”大佬的项目 <a href="https://aistudio.baidu.com/aistudio/projectdetail/1936908">https://aistudio.baidu.com/aistudio/projectdetail/1936908</a>进行修改。</p>
  </li>
  <li>
    <p>在其基础上，每个epoch执行更多的Generation，以及修改了超参数（ 偶尔判别器loss高时，会有些完全不像的图）。</p>
  </li>
  <li>
    <p>训练过程：<strong>Epoch 0 ~ Epoch 999</strong> 的LOSS及效果见下面动图：</p>

    <p><img src="/assets/2021/08-super-interstellar-terminal/loss.webp" alt="loss" /></p>
  </li>
  <li>
    <p><strong>具体训练项目地址见：</strong></p>

    <p><a href="https://aistudio.baidu.com/aistudio/projectdetail/2210138">Paddle2.0-通过LSGAN让我们看看AI预测的外星人长什么样子</a></p>
  </li>
  <li>
    <p>不足：</p>

    <ol>
      <li>
        <p>大概在200epochs就已经差不多，再训练到1000epochs反而效果还下降了。loss方面，判别器可以达到0.02，但生成器只能到0.8。这方面还可以优化</p>
      </li>
      <li>
        <p>最终会有不少彩色的杂点</p>
      </li>
      <li>
        <p>生成的外星生物矢量图有些还保留训练图的方格背景之类的。</p>
      </li>
      <li>
        <p>生成的外星生物可能有部分过拟合，为有些很向原来的。</p>
      </li>
    </ol>
  </li>
</ul>

<h4 id="d-后处理">d. 后处理</h4>

<ul>
  <li>
    <p>在叠加到现实图像中做AR效果时，使用cv处理优化这部分（具体见3-d中的描述）</p>
  </li>
  <li>
    <p>为外星生物配上背景介绍，定义他们出现的位置，建立外星生物图鉴</p>
  </li>
</ul>

<blockquote>
  <p><strong>生物图鉴：AI生成的外星生物</strong></p>
</blockquote>

<p><img src="/assets/2021/08-super-interstellar-terminal/tujian.webp" alt="tujian" /></p>

<h3 id="c2-识别现场环境cityscapesmodulepy">C.2 识别现场环境——CityscapesModule.py</h3>

<h4 id="a-模型">a. 模型</h4>

<p>PaddleSeg 中基于cityscapes数据集的SOTA模型</p>

<p>PaddleSeg训练了一个在cityscapes数据集上SOTA的模型。却很低调，只是放在contrib中，仅有个英文的介绍。里面的介绍还主要针对训练的，如果只是想要体验SOTA的cityscapes的效果是怎样的却很麻烦。本项目中化简了相关的代码，一行代码体验cityscapes分割。效果真的对得起SOTA的！</p>

<h4 id="b-相关文件">b. 相关文件</h4>

<ul>
  <li>
    <p>目录结构（单独使用本模块，只需修改<code class="language-plaintext highlighter-rouge">CityscapesModule.py</code>中的 im_path ）：</p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">.</span>
├── CityscapesModule.py
└── PetModel
    ├── modelCityscape.pdparams
    ├── pretrainedCityscape.pdparams
    └──mscale_ocr_cityscapes_autolabel_mapillary_ms_val.yml
</code></pre></div>    </div>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">pretrainedCityscape.pdparams</code>下载地址：<a href="https://bj.bcebos.com/paddleseg/dygraph/cityscapes/ocrnet_hrnetw48_mapillary/pretrained.pdparams">https://bj.bcebos.com/paddleseg/dygraph/cityscapes/ocrnet_hrnetw48_mapillary/pretrained.pdparams</a></p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">modelCityscape.pdparams</code>下载地址：<a href="https://bj.bcebos.com/paddleseg/dygraph/cityscapes/mscale_ocr_hrnetw48_cityscapes_autolabel_mapillary/model.pdparams">https://bj.bcebos.com/paddleseg/dygraph/cityscapes/mscale_ocr_hrnetw48_cityscapes_autolabel_mapillary/model.pdparams</a></p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">mscale_ocr_cityscapes_autolabel_mapillary_ms_val.yml</code> 为PaddleSeg模型的yml文件</p>
  </li>
</ul>

<h4 id="c-功能作用">c. 功能/作用</h4>

<p>让AI能感知环境里有哪几样物品，同时可以定位到其在图片中的具体位置。具体识别的物品如下：</p>

<p>(<strong>PS:注意真实返回的ID是从0开始的，所以是trainId-1</strong>，如sky实际返回的id是10 not 11）：</p>

<p><img src="/assets/2021/08-super-interstellar-terminal/sheet.webp" alt="sheet" /></p>

<h4 id="d-使用">d. 使用</h4>

<ul>
  <li>
    <p>运行<code class="language-plaintext highlighter-rouge">CityscapesModule.py</code>脚本,设置待处理图片的路径，将返回大小于原图片大小一样的二维数组pred，其取值是从0~18。</p>
  </li>
  <li>
    <p>可以拿这个二维数组作为mask，例如用<code class="language-plaintext highlighter-rouge">np.where(mask == index, 1, 0)</code>来截取自己感兴趣的区域，index取值为上表中<code class="language-plaintext highlighter-rouge">实际返回ID</code> ,也即 <code class="language-plaintext highlighter-rouge">trainID -1</code>。</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">CityscapesModule.py</code>中把<code class="language-plaintext highlighter-rouge">pred ×10</code>后保存成图片，见右下图（图片像素的灰度值从0~180）。</p>

    <p><img src="/assets/2021/08-super-interstellar-terminal/cityscapes.webp" alt="cityscapes" /></p>
  </li>
</ul>

<h3 id="c3-寻找隐藏在环境中的外星生物外星宠物alienpetmodulepy">C.3 寻找隐藏在环境中的外星生物（外星宠物）——alienPetModule.py</h3>

<p><img src="/assets/2021/08-super-interstellar-terminal/pets3.webp" alt="pets3" /></p>

<h4 id="a-准备">a. 准备</h4>

<ul>
  <li>
    <p>配合LSGAN生成的外星生物的形象，为起配置喜好，所在环境等，写入到<code class="language-plaintext highlighter-rouge">ConfigPet.py</code>中。</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">ConfigPet.py</code>中每个dict就是一种外星生物，该外星生物的id就是那个dict的key。</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">ConfigPet.py</code>中的areaIndex对应的就是cityScapes返回的物体ID，例如，areaIndex=10，则代表此生物是出现在天空中。</p>
  </li>
</ul>

<h4 id="b-作用">b. 作用</h4>

<p>实现对应位置的叠加AR效果。如：天空中出现飞在天上的外星生物，树丛中会出现喜欢在树上的草食性外星生物。</p>

<h4 id="c-步骤">c. 步骤</h4>

<h5 id="c1-准备">c.1. 准备</h5>

<p>基于LSGAN生成的外星生物矢量图。配置其参数，如：名字、大小、常出现的位置，习性描述、是否需要遮罩等。</p>

<h5 id="c2-选择">c.2. 选择</h5>

<p>先判断alienIndex是0（随机生成），还是-1（不生成），或者是&gt;0（生成id等于alienIndex的外星生物）。</p>

<h5 id="c3-定位">c.3. 定位</h5>

<p>基于分割模型得到的mask区域，按照外星生物可存在的位置判断是否出现外星生物，及其出现位置。具体见关键技术点说明。</p>

<h5 id="c4-合成">c.4. 合成</h5>

<p>根据外星生物的特性使用<code class="language-plaintext highlighter-rouge">cv2.seamleClone</code>，参数选用<code class="language-plaintext highlighter-rouge">MIXED_CLONE</code>或<code class="language-plaintext highlighter-rouge">NORMAL_CLONE</code>。具体见关键技术点说明。</p>

<h4 id="d-关键技术点">d. 关键技术点</h4>

<h5 id="d1-cv2seamlessclone三种图像合成效果">d.1 <code class="language-plaintext highlighter-rouge">cv2.seamlessClone</code>三种图像合成效果</h5>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># 会把src图的边缘进行模糊化，同时整个src图的色彩融合到dst中-&gt;需要src图较清晰，dst背景较简单，可以接受src图周边边缘模糊的场景
</span><span class="n">cv2</span><span class="p">.</span><span class="nf">seamlessClone</span><span class="p">(</span><span class="n">src</span><span class="p">,</span> <span class="n">dst</span><span class="p">,</span> <span class="n">src_mask</span><span class="p">,</span> <span class="n">center</span><span class="p">,</span> <span class="n">cv2</span><span class="p">.</span><span class="n">NORMAL_CLONE</span><span class="p">)</span>

<span class="c1"># 基于透明度的融合，src图中白色的区域会显得透明度高，看起来叠加的颜色比较透-&gt;适合dst背景较复杂，但对src图清晰度要求不高，src图背景是白色的场景
</span><span class="n">cv2</span><span class="p">.</span><span class="nf">seamlessClone</span><span class="p">(</span><span class="n">src</span><span class="p">,</span> <span class="n">dst</span><span class="p">,</span> <span class="n">src_mask</span><span class="p">,</span> <span class="n">center</span><span class="p">,</span> <span class="n">cv2</span><span class="p">.</span><span class="n">MIXED_CLONE</span><span class="p">)</span>

<span class="c1"># 会把src图变成灰度图合成到dst中-&gt;暂时看不到什么好用途
</span><span class="n">cv2</span><span class="p">.</span><span class="nf">seamlessClone</span><span class="p">(</span><span class="n">src</span><span class="p">,</span> <span class="n">dst</span><span class="p">,</span> <span class="n">src_mask</span><span class="p">,</span> <span class="n">center</span><span class="p">,</span> <span class="n">cv2</span><span class="p">.</span><span class="n">MONOCHROME_TRANSFER</span><span class="p">)</span>
</code></pre></div></div>

<p>借用别人的图，懒得生成了，左中右分别是：<code class="language-plaintext highlighter-rouge">NORMAL_CLONE</code>，<code class="language-plaintext highlighter-rouge">MIXED_CLONE</code>，<code class="language-plaintext highlighter-rouge">MONOCHROME_TRANSFER</code>：</p>

<p><strong>简单背景：</strong></p>

<p><img src="/assets/2021/08-super-interstellar-terminal/simple-clone.webp" alt="simple-clone" /></p>

<p><strong>复杂背景：</strong></p>

<p><img src="/assets/2021/08-super-interstellar-terminal/complex-clone.webp" alt="complex-clone" /></p>

<p>效果好坏于背景图dst及前景图src都有关系</p>

<h5 id="d2-结合mask的优化版seamlesclone图像合成效果代码见alienpetmodulepy中的maskofwhitebgroiareacheck">d.2 结合mask的优化版seamlesClone图像合成效果——代码见alienPetModule.py中的maskOfWhiteBG()，roiAreaCheck()</h5>

<ul>
  <li>
    <ol>
      <li>把src的外星生物图转成HSV格式，通过V通道，V大于200得到二值化的mask。HSV的V分量可以当作是亮度，在本次LSGAN生成的外星人中基本都是白色底的，可以抠处白色底</li>
    </ol>
  </li>
  <li>
    <ol>
      <li>二值化的图进行开运算。去除LSGAN中生成的一些彩色噪声点，得到外星生物的mask，宁愿漏也不要去多了。因为合成时有个渐变，自然就把杂点淡化了。</li>
    </ol>
  </li>
</ul>

<p><img src="/assets/2021/08-super-interstellar-terminal/binary.webp" alt="binary" /></p>

<ul>
  <li>
    <ol>
      <li>把2中的二值化图进行边缘裁切，使mask图的四个边都有白色区域接触。这可能是seamlessClone的一个bug，若白色区域不接触图像边缘，<strong>其合成时的位置是按白色区域的中心点位置，不是mask图像的中心点位置</strong>，切记！</li>
    </ol>
  </li>
  <li>
    <ol>
      <li>根据裁切后的mask，重新计算中心点左边center=(x,y)。seamlessClone的center参数是src的中心点在dst图中的位置。</li>
    </ol>
  </li>
</ul>

<h5 id="d3-结合cityscapes分割的ar定位代码见alienpetmodulepy中的erode2lefttoplefttop2center">d.3 结合cityScapes分割的AR定位——代码见alienPetModule.py中的erode2LeftTop（），leftTop2Center()</h5>

<ul>
  <li>
    <ol>
      <li>利用cityScapes返回的pred图中，获取画面中某个物品的mask。利用<code class="language-plaintext highlighter-rouge">np.where(pred==areaIndex, 1, 0)</code>生成二值化mask。</li>
    </ol>
  </li>
</ul>

<p><img width="300" /></p>

<ul>
  <li>
    <ol>
      <li>根据用户图片dst的大小，及外星宠物的scaleRatio参数，调整外星宠物图片的大小。大小设置为dst图像长边scaleRatio，再有一个（0.8~1）倍的随机</li>
    </ol>
  </li>
  <li>
    <ol>
      <li>对二值化mask图4个边缘的值都设置0。相当于mask图边缘多了一个黑色的框，方便待会腐蚀时，可以从边缘也腐蚀。否则，贴着边缘值为1的点待会都不会倍腐蚀</li>
    </ol>
  </li>
  <li>
    <ol>
      <li>以调整后的外星宠物图像的边长d，对二值化mask图像进行opencv的腐蚀操作。腐蚀后，值为1的点则为可选的外星宠物图像进行seamlessClone的center点。腐蚀相当于我们的卷积，当该点腐蚀后仍为1，则证明其腐蚀前周围值为1的点能组成一个d×d的形状</li>
    </ol>
  </li>
</ul>

<p><img src="/assets/2021/08-super-interstellar-terminal/corrosion.webp" alt="corrosion" /></p>

<ul>
  <li>
    <ol>
      <li>若腐蚀后，mask图都为0，则缩小腐蚀的kernel为原来的0.6，再重复4的步骤。步骤4完成后没能找到mask中为1的点则证明，没有足够位置完全把外星宠物图像放进去，我们缩小要求，要求某区域只要有60%的外星宠物的大小则继续融合进去</li>
    </ol>
  </li>
  <li>
    <ol>
      <li>若4或5步骤后，mask中有值为1的点，则满足条件,可进行图像合成</li>
    </ol>
  </li>
</ul>

<h5 id="d4-前后关系">d.4 前后关系</h5>

<ul>
  <li>
    <p>有外星人又则怎能少了外星飞碟呢。外星飞船要逼真需要又遮挡关系，我们可以利用<code class="language-plaintext highlighter-rouge">cityscapesModule</code>识别出的天空区域。</p>
  </li>
  <li>
    <p>一句代码实现遮挡：</p>

    <p>【伪代码】 np.where(mask=天空的index, 已叠加飞船的图，原图）</p>

    <p><img src="/assets/2021/08-super-interstellar-terminal/sky.webp" alt="sky" /></p>
  </li>
</ul>

<h3 id="c4-外星人显形alienheadmodulepy">C.4 外星人显形——alienHeadModule.py</h3>

<h4 id="a-模型-1">a. 模型</h4>

<p>Paddlehub landmark模型</p>

<p>landmark的68个人脸关键点模型具体介绍请见官方介绍：<a href="https://gitee.com/PaddlePaddle/PaddleHub/tree/release/v2.1/modules/image/keypoint">https://gitee.com/PaddlePaddle/PaddleHub/tree/release/v2.1/modules/image/keypoint</a></p>

<h4 id="b-作用-1">b. 作用</h4>

<p>实现外星人换脸</p>

<h4 id="c-步骤-1">c. 步骤</h4>

<h5 id="c1-准备-1">c.1. 准备</h5>

<ul>
  <li>
    <p>找到一张外星人正面的照片与侧面的照片，扣出其形象保存图片。</p>
  </li>
  <li>
    <p>我们需要手动用labelme的keypoint为其标上68个关键点，大概就好，不用太精确。landmark数据按labelme格式保存到json中。</p>
  </li>
  <li>
    <p>配置外星人的人脸参数到<code class="language-plaintext highlighter-rouge">ConfigHead.py</code>中。</p>
  </li>
</ul>

<p><img src="/assets/2021/08-super-interstellar-terminal/alien1.webp" alt="alien1" /></p>

<h5 id="c2-对齐">c.2. 对齐</h5>

<ul>
  <li>
    <p>对用户发来的图片，利用PaddleHub的landmark模型获取图片中的人脸特征点。</p>
  </li>
  <li>
    <p>正脸使用正脸的外星人照片的，侧脸用侧脸的预处理照片。若角度太偏则不进行处理。然后，使用landmark中脸颊的特征点求中点进行人脸图像位置上的对齐。并根据用户图片的人脸对外星人人脸进行大小调整</p>
  </li>
</ul>

<h5 id="c3-融合粘贴">c.3. 融合粘贴</h5>

<ul>
  <li>
    <p>截取外星人人脸，生成一个上到下的渐透明的遮罩图。用<code class="language-plaintext highlighter-rouge">cv2.seamlessCloned</code>的NORMAL_CLONE复制到原人脸位置，但因为seamlessClone没法调参数的，外星人形象融在背景里面，不太明显不清晰。</p>
  </li>
  <li>
    <p>截取外星人人脸及颈部及上半身，生成一个上到下的渐透明的遮罩图。用<code class="language-plaintext highlighter-rouge">cv2.addWeight</code>把外星人脸与1中所述的人脸进行透明度融合。</p>
  </li>
</ul>

<p><img src="/assets/2021/08-super-interstellar-terminal/alien2.webp" alt="alien2" /></p>

<h4 id="d-关键技术点-1">d. 关键技术点</h4>

<h5 id="d1-问题分析">d.1 问题分析</h5>

<p>直接把外星人脸贴到用户图上边缘会很硬，如上图中的左图。</p>

<h5 id="d2-单方向渐变遮罩">d.2 单方向渐变遮罩</h5>

<p>使用从上到下的遮罩，可以有效渐变过度到身体。上到下的渐变mask生成见<code class="language-plaintext highlighter-rouge">CVTools.py</code>中的gradientMask()。只用上到下的渐变，是因为外星人头会比正常人头大，本身过渡要求不高，所以上，左，右方向的融合过渡，依靠seamlessClone则可较好处理。剩下 下 这个方向是连接颈部或身体的需要渐变遮罩过渡。（见下图）</p>

<p><img src="/assets/2021/08-super-interstellar-terminal/alien1.webp" alt="alien3" /></p>

<h5 id="d3-双重图片叠加融合">d.3 双重图片叠加融合</h5>

<ul>
  <li>
    <p>只是使用seamlessClone融合，会因为seamlessClone算法影响，把贴上去的外星人图颜色变得较多，算法只为让其融合到附近环境。原图是这样的：</p>

    <p><img src="/assets/2021/08-super-interstellar-terminal/alien4.webp" alt="alien4" /></p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">cv2.seamlessClone</code>没有参数调节，使得整个外星人头的颜色都变了。见下图左。   双重图片叠加融合，效果见下图右。</p>

    <p><img src="/assets/2021/08-super-interstellar-terminal/alien5.webp" alt="alien5" /></p>
  </li>
  <li>
    <p>双重图片叠加融合步骤：（具体代码为项目中：<code class="language-plaintext highlighter-rouge">alienHeadModule.py</code>)</p>

    <ul>
      <li>
        <ol>
          <li>生成head的渐变mask。使用d2所述的方法生成头部的渐变遮罩。</li>
        </ol>
      </li>
      <li>
        <ol>
          <li>hard paste head。使用直接粘贴替换的方式，把外星人的head粘贴到用户的图的适当位置。</li>
        </ol>
      </li>
      <li>
        <ol>
          <li>生成Body的渐变mask。把外星人头及颈部或身体上半部 对齐head的位置，使用d2所述的方法生成mask。</li>
        </ol>
      </li>
      <li>
        <ol>
          <li>seamlessClone Body。使用3所述的mask图，把外星人身体上半部seamlessClone到用户的图中，需要保证粘贴后头的位置是跟步骤2一样的。</li>
        </ol>
      </li>
      <li>
        <ol>
          <li>合成。使用<code class="language-plaintext highlighter-rouge">cv2.addWeight</code>实现透明度叠加步骤2与步骤4的图。 <code class="language-plaintext highlighter-rouge">cv2.addWeighted(src1, alpha, src2, beta, gamma)</code>，根据不同外星人的皮肤深浅调节alpha，beta。最终效果见上图。</li>
        </ol>
      </li>
    </ul>
  </li>
</ul>

<h3 id="c5-寻找生长在地球的外星植物vegetatemodulepy">C.5 寻找生长在地球的外星植物——vegetateModule.py</h3>

<p><img src="/assets/2021/08-super-interstellar-terminal/vegetate1.webp" alt="vegetate1" /></p>

<h4 id="a-准备-1">a. 准备</h4>

<p>找一些外星植物的图片，实现非深度学习的基于<strong>图像技术</strong>的颜色纹理迁移。也可以是一些想要的风格的图，如下图中的任意一种
<img src="/assets/2021/08-super-interstellar-terminal/vegetate2.webp" alt="vegetate2" /></p>

<h4 id="b-作用-2">b. 作用</h4>

<p>把环境中的植物变换成外星风格的植物</p>

<h4 id="c-步骤-2">c. 步骤</h4>

<h5 id="c1-准备-2">c.1. 准备</h5>

<p>基于这些外星植物，在<code class="language-plaintext highlighter-rouge">ConfigVegetae.py</code>中配置其参数，如：名字、常出现的位置，习性描述等</p>

<h5 id="c2-选择-1">c.2. 选择</h5>

<p>先判断vegetateIndex是0（随机生成），还是-1（不生成），或者是&gt;0（生成id等于vegetateIndex是0的外星植物）。</p>

<h5 id="c3-定位-1">c.3. 定位</h5>

<p>基于分割模型得到的mask区域，按照外星生物可存在的位置判断是否出现该外星植物，及其出现位置。</p>

<h5 id="c4-合成-1">c.4. 合成</h5>

<p>根据外星植物的特性使用yuv颜色通道合成。具体见关键技术点说明。</p>

<h4 id="d-关键技术点-2">d. 关键技术点</h4>

<h5 id="d1-yuv颜色区间">d.1 YUV颜色区间</h5>

<ul>
  <li>
    <p>比较熟悉CV的同志们可以忽略此节</p>
  </li>
  <li>
    <p>我们使用CV的方法进行处理时，通常不会再RGB颜色空间处理，而是转到HLS/HSV 也有 YUV颜色空间进行处理。这样作的好处是 其中的H 通道在一定程度上可以表示其颜色。通过这样来选择特定的颜色，S代表饱和度，V代表亮度。而YUV中 Y是亮度，U,V分别是 蓝 红 通道。</p>
  </li>
  <li>
    <p>YUV具体介绍可见：<a href="https://zhuanlan.zhihu.com/p/95952096">https://zhuanlan.zhihu.com/p/95952096</a></p>
  </li>
</ul>

<h5 id="d2-yuv颜色融合">d.2 YUV颜色融合</h5>

<ul>
  <li>
    <p>我们也可以通过Y通道融合亮度，保留外星的U,V通道，即保留其颜色。当两个图片融合时，通过调节融合的Y通道的权重，控制合成出来的颜色亮度。</p>

    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># 把图片style，content转到yuv空间
</span><span class="n">yuv</span> <span class="o">=</span> <span class="n">cv2</span><span class="p">.</span><span class="nf">cvtColor</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="nf">float32</span><span class="p">(</span><span class="n">style</span><span class="p">),</span> <span class="n">cv2</span><span class="p">.</span><span class="n">COLOR_BGR2YUV</span><span class="p">)</span>
<span class="n">y</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span> <span class="o">=</span> <span class="n">cv2</span><span class="p">.</span><span class="nf">split</span><span class="p">(</span><span class="n">yuv</span><span class="p">)</span>
<span class="n">yuv2</span> <span class="o">=</span> <span class="n">cv2</span><span class="p">.</span><span class="nf">cvtColor</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="nf">float32</span><span class="p">(</span><span class="n">content</span><span class="p">),</span> <span class="n">cv2</span><span class="p">.</span><span class="n">COLOR_BGR2YUV</span><span class="p">)</span>
<span class="n">h</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span> <span class="o">=</span> <span class="n">cv2</span><span class="p">.</span><span class="nf">split</span><span class="p">(</span><span class="n">yuv2</span><span class="p">)</span>
  
<span class="c1"># 根据ratio这个比例来合成 style 与 content两张图
</span><span class="n">hy</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">array</span><span class="p">((</span><span class="n">h</span> <span class="o">*</span> <span class="n">ratio</span> <span class="o">+</span> <span class="n">y</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">ratio</span><span class="p">)),</span> <span class="sh">'</span><span class="s">uint8</span><span class="sh">'</span><span class="p">)</span>
<span class="c1"># hy = np.clip(hy, 0, 255)
</span>  
<span class="c1"># 两张图进行合成
</span><span class="n">content</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">dstack</span><span class="p">((</span><span class="n">hy</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">))</span>
<span class="n">content</span> <span class="o">=</span> <span class="n">cv2</span><span class="p">.</span><span class="nf">cvtColor</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="nf">float32</span><span class="p">(</span><span class="n">content</span><span class="p">),</span> <span class="n">cv2</span><span class="p">.</span><span class="n">COLOR_YUV2BGR</span><span class="p">)</span>
</code></pre></div>    </div>
  </li>
</ul>

<h3 id="c6-寻找被外星人隐藏起来的外星建筑sandmodulepy">C.6 寻找被外星人隐藏起来的外星建筑——sandModule.py</h3>

<p><img src="/assets/2021/08-super-interstellar-terminal/sand1.webp" alt="sand1" /></p>

<h4 id="a-准备-2">a. 准备</h4>

<p>使用Msgnet迁移训练的沙画模型，实现基于<strong>深度学习</strong>的风格迁移。 大家可以对比一下5中的外星植物的效果，那是基于CV技术的迁移</p>

<h4 id="b-作用-3">b. 作用</h4>

<p>把环境中的建筑变成像流沙组合起来的建筑</p>

<h4 id="c-步骤-3">c. 步骤</h4>

<h5 id="c1-定位">c.1. 定位</h5>

<p>基于分割模型得到的mask区域，定位areaIndex==2,即building的区域。</p>

<h5 id="c2-图像迁移">c.2. 图像迁移</h5>

<p>把建筑转成灰度图，然后用msgnet迁移成流沙的风格。</p>

<h3 id="c7-使用imggeneratemodule-建立alien-server或直接调用">C.7 使用ImgGenerateModule 建立Alien Server或直接调用</h3>

<h4 id="a-直接调用函数">a. 直接调用函数</h4>

<p>ImgGenerateModule可以单独使用或<code class="language-plaintext highlighter-rouge">app.py</code>也可单独建立flask的图像生成服务供其他用途使用</p>

<ul>
  <li>
    <p>初始化函数定义各个模型文件夹及图片素材的位置</p>

    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">imgGenerator</span> <span class="o">=</span> <span class="nc">ImgGenerator</span><span class="p">(</span>
    <span class="n">debug</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
    <span class="n">ymlPathSeg</span><span class="o">=</span><span class="sh">'</span><span class="s">PetModel/mscale_ocr_cityscapes_autolabel_mapillary_ms_val.yml</span><span class="sh">'</span><span class="p">,</span>    <span class="c1">#cityscapes分割模型的yml
</span>    <span class="n">modelPathSeg</span><span class="o">=</span><span class="sh">'</span><span class="s">PetModel/modelCityscape.pdparams</span><span class="sh">'</span><span class="p">,</span>    <span class="c1">#cityscapes分割模型文件
</span>    <span class="n">modelPathSand</span><span class="o">=</span><span class="sh">'</span><span class="s">msgnet</span><span class="sh">'</span><span class="p">,</span>    <span class="c1">#沙画模型文件夹
</span>    <span class="n">picPathHead</span><span class="o">=</span><span class="sh">'</span><span class="s">HeadPic/</span><span class="sh">'</span><span class="p">,</span>    <span class="c1">#外星人头素材
</span>    <span class="n">picPathPet</span><span class="o">=</span><span class="sh">'</span><span class="s">PetPic/</span><span class="sh">'</span><span class="p">,</span>    <span class="c1">#外星生物素材
</span>    <span class="n">picPathVeg</span><span class="o">=</span><span class="sh">'</span><span class="s">VegPic</span><span class="sh">'</span>    <span class="c1">#外星植物及外星建筑素材
</span><span class="p">)</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p>调用函数生成</p>

    <p>输入是图片路径：</p>

    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">rc</span><span class="p">,</span> <span class="n">img</span><span class="p">,</span> <span class="n">des</span> <span class="o">=</span> <span class="n">imgGenerator</span><span class="p">.</span><span class="nf">run</span><span class="p">(</span>
    <span class="n">dstPath</span><span class="p">,</span>
    <span class="n">alienHeadIndex</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">vegetateIndex</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">environmentIndex</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">alienPetIndex</span><span class="o">=</span><span class="mi">0</span>
<span class="p">)</span>
</code></pre></div>    </div>

    <p>输入直接是图片：</p>

    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">rc</span><span class="p">,</span> <span class="n">img</span><span class="p">,</span> <span class="n">des</span> <span class="o">=</span> <span class="n">imgGenerator</span><span class="p">.</span><span class="nf">runImg</span><span class="p">(</span>
    <span class="n">img</span><span class="p">,</span>
    <span class="n">alienHeadIndex</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">vegetateIndex</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">environmentIndex</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">alienPetIndex</span><span class="o">=</span><span class="mi">0</span>
<span class="p">)</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p>参数说明</p>

    <table>
      <thead>
        <tr>
          <th style="text-align: left">参数名</th>
          <th style="text-align: left">必选</th>
          <th style="text-align: left">类型</th>
          <th>说明</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td style="text-align: left">img/dstPath</td>
          <td style="text-align: left">是</td>
          <td style="text-align: left">string</td>
          <td>待处理图片或待处理图片的地址</td>
        </tr>
        <tr>
          <td style="text-align: left">alienHeadIndex</td>
          <td style="text-align: left">否</td>
          <td style="text-align: left">int</td>
          <td>是否进行换外星人头，-1为不处理，0为随机，&gt;0为指定index为该值的外星人</td>
        </tr>
        <tr>
          <td style="text-align: left">vegetateIndex</td>
          <td style="text-align: left">否</td>
          <td style="text-align: left">int</td>
          <td>是否添加外星植物，-1为不处理，0为随机，&gt;0为指定index为该值的外星植物</td>
        </tr>
        <tr>
          <td style="text-align: left">environmentIndex</td>
          <td style="text-align: left">否</td>
          <td style="text-align: left">int</td>
          <td>是否生成外星建筑外墙，-1为不处理，&gt;0为生成</td>
        </tr>
        <tr>
          <td style="text-align: left">alienPetIndex</td>
          <td style="text-align: left">否</td>
          <td style="text-align: left">int</td>
          <td>是否进行添加外星生物，-1为不处理，0为随机，&gt;0为指定index为该值的外星生物</td>
        </tr>
      </tbody>
    </table>
  </li>
  <li>
    <p>返回说明</p>

    <table>
      <thead>
        <tr>
          <th style="text-align: left">参数名</th>
          <th style="text-align: left">类型</th>
          <th>说明</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td style="text-align: left">result_code</td>
          <td style="text-align: left">dict</td>
          <td>{ 返回结果代号 ：返回结果描述}，result_code参数具体见代码中说明，200为正常生成</td>
        </tr>
        <tr>
          <td style="text-align: left">img</td>
          <td style="text-align: left">numpy array</td>
          <td>生成的图片或原图片(没有适合的位置生成时返回原图片)</td>
        </tr>
        <tr>
          <td style="text-align: left">dis</td>
          <td style="text-align: left">dict</td>
          <td>包含生成外星人/生成外星植物/生成外星建筑/生成外星宠物的参数的字典. 没有进行处理则为空字典</td>
        </tr>
      </tbody>
    </table>
  </li>
</ul>

<h4 id="b-建server访问图像生成接口-本项目中使用的方式">b. 建server，访问图像生成接口 (本项目中使用的方式）</h4>

<p>不确定什么原因，以前Wechaty都可以在AI Studio的脚本任务跑，现在好像不可以了，从AI Studio脚本任务无法访问外网的端口了，可以ping通外网。所以，需要另外找自己的主机作深度学习这部分的图片推理生成，因此直接把上述功能再弄到flask中，弄了个接口。</p>

<ul>
  <li>
    <p>接口代码见：项目中的<code class="language-plaintext highlighter-rouge">app.py</code>脚本</p>
  </li>
  <li>
    <p>接口文档说明见showdoc：<a href="https://www.showdoc.com.cn/1525661816374166/7370335053618085">https://www.showdoc.com.cn/1525661816374166/7370335053618085</a></p>
  </li>
  <li>
    <p>并发问题：flask接口默认允许并发，即可能很短时间内或同一时间调用里面的函数的，但鉴于我们的运算都是GPU的，不支持并发调用。所以，使用了gevent来设置阻塞的服务。即会一个处理完再调用处理下一个，中间还没处理的会等待。</p>
  </li>
</ul>

<h3 id="c8-识别图像的拍摄位置">C.8 识别图像的拍摄位置</h3>

<h4 id="a-前提条件需同时满足下面条件">a. 前提条件（需同时满足下面条件）</h4>

<ul>
  <li>
    <p>用户是在微信中，用<strong>原图</strong>发送照片给我们</p>
  </li>
  <li>
    <p>照片拍照时，其拍照设置中打开了<strong>保存地理位置信息</strong></p>
  </li>
</ul>

<h4 id="b-背景情况介绍">b. 背景情况介绍</h4>

<ul>
  <li>
    <p>若用户满足上述2条件，则保存的照片里将含有exif信息。该EXIF信息，可在Windows中图片的属性中看到，GPS，拍照日期等信息：</p>

    <p><img src="/assets/2021/08-super-interstellar-terminal/location1.webp" alt="location1" /></p>
  </li>
  <li>
    <p>EXIF的详细介绍可见，这里不详细叙述了:</p>

    <p><a href="http://www.360doc.com/content/18/0303/07/7793103_733844932.shtml">http://www.360doc.com/content/18/0303/07/7793103_733844932.shtml</a></p>
  </li>
</ul>

<h4 id="c-获取经纬度exifmodulepy">c. 获取经纬度——exifModule.py</h4>

<ul>
  <li>
    <p>python中有pip库可以直接获取照片的exif信息， 具体代码可见项目工程中的<code class="language-plaintext highlighter-rouge">exifModule.py</code></p>
  </li>
  <li>
    <p>本脚本中提取了最关键的经度与纬度信息，还有拍照日期可供调用</p>
  </li>
</ul>

<h4 id="d-获取具体位置geomodulepy">d. 获取具体位置——geoModule.py</h4>

<ul>
  <li>
    <p>具体代码可见项目工程中的<code class="language-plaintext highlighter-rouge">geoModule.py</code></p>
  </li>
  <li>
    <p>步骤：把获得的经纬度信息去请求开放的地图api，获取具体地址.这个方法的名称为：逆地址编码</p>
  </li>
  <li>
    <p>横向比较了： 百度，腾讯，高德地图，发现高德给出的个人免费调用量有 3W/日，其他两家只有几k。最终选用了高德的api</p>
  </li>
  <li>
    <p>高德api获取地址步骤（非常简单）：</p>

    <table>
      <thead>
        <tr>
          <th>序号</th>
          <th>高德流程</th>
          <th>备注</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>1</td>
          <td>注册</td>
          <td>需要支付宝扫码实名</td>
        </tr>
        <tr>
          <td>2</td>
          <td>新建应用</td>
          <td>按默认点确定即可</td>
        </tr>
        <tr>
          <td>3</td>
          <td>复制那个应用的key进行调用</td>
          <td>调用代码见<code class="language-plaintext highlighter-rouge">geoModule.py</code>，请使用自己的gaode_key测试</td>
        </tr>
      </tbody>
    </table>
  </li>
  <li>
    <p>详细图文描述可见：<a href="https://zhuanlan.zhihu.com/p/371682461">https://zhuanlan.zhihu.com/p/371682461</a></p>
  </li>
</ul>

<h2 id="d-上手及部署指南">D. 上手及部署指南</h2>

<h3 id="d1-配置要求">D.1 配置要求</h3>

<p>图像部分，因为用了PaddleSeg需要一台6G显存以上的主机，4G显存的没测试过，可以尝试调小 ImgGeneratorModule 中的 inputSize, 在DL处理前先缩小图片。</p>

<h3 id="d2-部署方案">D.2 部署方案</h3>

<p>建议选择方案一</p>

<ul>
  <li>
    <p>方案一：一台显存6G，内存16G电脑（部署整个项目）</p>
  </li>
  <li>
    <p>方案二：一台普通云端服务器（1核2G之类的）+ 一台有外网IP的显存6G，内存16G电脑(部署图像部分：ImgGenerateModule)</p>
  </li>
  <li>
    <p>方案三：一台有GPU的云端服务器</p>
  </li>
</ul>

<h3 id="d3-模型下载">D.3 模型下载</h3>

<p>需下载以下模型：</p>

<ul>
  <li>
    <p>简化后的PadlleSeg的cityscapes的SOTA模型（<code class="language-plaintext highlighter-rouge">CityscapesModule.py</code>需要）</p>

    <p>AI Studio数据页：<a href="https://aistudio.baidu.com/aistudio/datasetdetail/102892">https://aistudio.baidu.com/aistudio/datasetdetail/102892</a></p>
  </li>
  <li>
    <p>流沙效果/沙画效果模型（<code class="language-plaintext highlighter-rouge">sandModule.py</code>需要）</p>

    <p>AI Studio数据页：<a href="https://aistudio.baidu.com/aistudio/datasetdetail/102698">https://aistudio.baidu.com/aistudio/datasetdetail/102698</a></p>
  </li>
  <li>
    <p>PaddleSeg（<code class="language-plaintext highlighter-rouge">CityscapesModule.py</code>需要）</p>

    <p>AI Studio数据页：<a href="https://aistudio.baidu.com/aistudio/datasetdetail/102136">https://aistudio.baidu.com/aistudio/datasetdetail/102136</a></p>

    <p>或直接去GitHub：<code class="language-plaintext highlighter-rouge">git clone https://github.com/PaddlePaddle/PaddleSeg</code></p>

    <p>或者去Gitee：<code class="language-plaintext highlighter-rouge">git clone https://gitee.com/PaddlePaddle/PaddleSeg</code></p>
  </li>
  <li>
    <p>生成外星人矢量图模型（非必需，若要自己新增生成外星生物才需要）</p>

    <p>AI Studio数据页：<a href="https://aistudio.baidu.com/aistudio/datasetdetail/103316">https://aistudio.baidu.com/aistudio/datasetdetail/103316</a></p>
  </li>
</ul>

<h3 id="d4-部署过程">D.4 部署过程</h3>

<ol>
  <li>
    <p>申请Wechaty Token <a href="https://wechaty.js.org"><img src="https://img.shields.io/badge/Powered%20By-Wechaty-brightgreen.svg" alt="Powered by Wechaty" /></a> <a href="https://github.com/wechaty/python-wechaty"><img src="https://img.shields.io/badge/Wechaty-Python-blue" alt="Wechaty in Python" /></a></p>

    <p>具体请访问Wechaty官网: <a href="https://wechaty.js.org/">https://wechaty.js.org/</a></p>
  </li>
  <li>
    <p>快速上手</p>

    <p>请参考<a href="https://aistudio.baidu.com/aistudio/personalcenter/thirdview/638343">@Lovely-Pig</a>的文章: <a href="https://aistudio.baidu.com/aistudio/projectdetail/1836012">教你用AI Studio+Wechaty+阿里云白嫖一个智能微信机器人</a></p>
  </li>
  <li>
    <p>云服务器</p>

    <ul>
      <li>
        <p>本项目用到了阿里云的云服务器ECS，链接: <a href="https://www.aliyun.com/product/ecs">云服务器ECS</a></p>
      </li>
      <li>
        <p>购买实例后登录<a href="https://ecs.console.aliyun.com">控制台</a>，实例名称和主机名可以自行更改，记住<strong>公网IP</strong></p>
      </li>
      <li>
        <p>有任何不明白的请访问: <a href="https://help.aliyun.com/product/25365.html">云服务器ECS官方文档</a></p>
      </li>
    </ul>
  </li>
  <li>
    <p>云数据库</p>

    <ul>
      <li>
        <p>本项目用到了阿里云的云数据库RDS MySQL版，链接: <a href="https://www.aliyun.com/product/rds">云数据库RDS MySQL版</a></p>
      </li>
      <li>
        <p>购买实例后登录<a href="https://rds.console.aliyun.com">控制台</a>，创建一个数据库，名为 <code class="language-plaintext highlighter-rouge">super-interstellar-terminal</code> .</p>
      </li>
      <li>
        <p>创建一个普通账号，授权数据库填写<code class="language-plaintext highlighter-rouge">super-interstellar-terminal</code>，权限为读写（DDL+DML），记住<strong>用户名</strong>和<strong>密码</strong></p>
      </li>
      <li>
        <p>在左侧<strong>数据库连接</strong>处找到外网地址，小本本记下来</p>
      </li>
      <li>
        <p>设置白名单，将云服务器实例的<strong>公网IP</strong>加入白名单</p>
      </li>
      <li>
        <p>有任何不明白的请访问: <a href="https://help.aliyun.com/product/26090.html">云数据库RDS官方文档</a></p>
      </li>
    </ul>
  </li>
  <li>
    <p>云存储</p>

    <ul>
      <li>
        <p>本项目用到了阿里云的对象存储OSS，链接: <a href="https://www.aliyun.com/product/oss">对象存储OSS</a></p>
      </li>
      <li>
        <p>开通后登录<a href="https://oss.console.aliyun.com">控制台</a>，创建一个Bucket，名为<code class="language-plaintext highlighter-rouge">super-interstellar-terminal</code>.</p>
      </li>
      <li>
        <p>登录<a href="https://ram.console.aliyun.com">RAM控制台</a>，创建一个用户，访问方式选择<strong>编程访问</strong>，记住<code class="language-plaintext highlighter-rouge">AccessKey ID</code>和<code class="language-plaintext highlighter-rouge">AccessKey Secret</code>.</p>
      </li>
      <li>
        <p>有任何不明白的请访问: <a href="https://help.aliyun.com/product/31815.html">云存储OSS官方文档</a></p>
      </li>
    </ul>
  </li>
  <li>
    <p>开启数据库server</p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># 以任何一种你喜欢❤的方式远程登陆到阿里云的云服务器</span>

<span class="c"># 克隆本代码仓库</span>
<span class="nb">cd</span> ~/
git clone https://github.com/kevinfu1717/SuperInterstellarTerminal.git

<span class="c"># 安装MySQL客户端</span>
<span class="nb">sudo </span>apt <span class="nb">install </span>mysql-client-core-8.0

<span class="c"># 开启数据库server</span>
<span class="nb">cd</span> ~/SuperInterstellarTerminal/bot/
python3 <span class="nt">-m</span> pip <span class="nb">install</span> <span class="nt">-r</span> requirements.txt
<span class="nb">nohup </span>python3 server/database.py <span class="o">&gt;</span>/dev/null 2&gt;&amp;1 &amp;
</code></pre></div>    </div>
  </li>
  <li>
    <p>开启图像处理server</p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># 远程登陆到一台很牛逼的服务器（不是阿里云的云服务器）</span>

<span class="c"># 克隆本代码仓库</span>
<span class="nb">cd</span> ~/
git clone https://github.com/kevinfu1717/SuperInterstellarTerminal.git

<span class="c"># 开启图像处理server</span>
<span class="nb">cd</span> ~/SuperInterstellarTerminal/
python3 <span class="nt">-m</span> pip <span class="nb">install</span> <span class="nt">-r</span> requirements.txt
<span class="nb">nohup </span>python3 app.py <span class="o">&gt;</span>/dev/null 2&gt;&amp;1 &amp;
</code></pre></div>    </div>
  </li>
  <li>
    <p>设置环境变量</p>

    <p><code class="language-plaintext highlighter-rouge">OSS_ENDPOINT</code>的设置可参考: <a href="https://help.aliyun.com/document_detail/31837.html?spm=a2c4g.11186623.6.611.554e6d13isyAAt">访问域名（Endpoint）</a></p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">export </span><span class="nv">WECHATY_PUPPET</span><span class="o">=</span><span class="s2">"wechaty-puppet-service"</span>
<span class="nb">export </span><span class="nv">WECHATY_PUPPET_SERVICE_TOKEN</span><span class="o">=</span><span class="s2">"&lt;your wechaty token&gt;"</span>    <span class="c"># wechaty的token</span>
<span class="nb">export </span><span class="nv">DB_USER</span><span class="o">=</span><span class="s2">"&lt;your database user name&gt;"</span>    <span class="c"># 云数据库账号的用户名</span>
<span class="nb">export </span><span class="nv">DB_PASSWORD</span><span class="o">=</span><span class="s2">"&lt;your database password&gt;"</span>    <span class="c"># 云数据库账号的密码</span>
<span class="nb">export </span><span class="nv">DB_DATABASE</span><span class="o">=</span><span class="s2">"&lt;your database name&gt;"</span>    <span class="c"># 云数据库的数据库名，填写为super-interstellar-terminal</span>
<span class="nb">export </span><span class="nv">DB_SERVER_HOST</span><span class="o">=</span><span class="s2">"&lt;your database server host&gt;"</span>    <span class="c"># 开启数据库server的服务器地址，一般是云服务器的公网IP</span>
<span class="nb">export </span><span class="nv">ACCESS_KEY_ID</span><span class="o">=</span><span class="s2">"&lt;your AccessKey ID&gt;"</span>    <span class="c"># RAM用户的AccessKey ID</span>
<span class="nb">export </span><span class="nv">ACCESS_KEY_SECRET</span><span class="o">=</span><span class="s2">"&lt;your AccessKey Secret&gt;"</span>    <span class="c"># RAM用户的AccessKey Secret</span>
<span class="nb">export </span><span class="nv">OSS_BUCKET_NAME</span><span class="o">=</span><span class="s2">"&lt;your oss bucket name&gt;"</span>    <span class="c"># 云存储的Bucket，填写为super-interstellar-terminal</span>
<span class="nb">export </span><span class="nv">OSS_ENDPOINT</span><span class="o">=</span><span class="s2">"&lt;your oss endpoint&gt;"</span>    <span class="c"># 云存储的访问域名</span>
<span class="nb">export </span><span class="nv">IMG_SERVER_HOST</span><span class="o">=</span><span class="s2">"&lt;your img server host&gt;"</span>    <span class="c"># 开启图像处理server的服务器地址</span>
<span class="nb">export </span><span class="nv">DEVELOPERS</span><span class="o">=</span><span class="s2">"&lt;your developer cipher&gt;"</span>    <span class="c"># 给予开发者特权的暗号</span>
</code></pre></div>    </div>
  </li>
  <li>
    <p>运行bot</p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cd</span> ~/super-interstellar-terminal/bot/
python3 <span class="nt">-m</span> pip <span class="nb">install</span> <span class="nt">-r</span> requirements.txt
<span class="nb">nohup </span>python3 bot.py &amp;
</code></pre></div>    </div>
  </li>
</ol>

<h2 id="e-总结">E. 总结</h2>

<h3 id="e1-展望">E.1 展望</h3>

<h4 id="a-让心在宇宙漂流">a. 让心在宇宙漂流</h4>

<p>此项目结合了轻社交的星际漂流瓶，让大家可以抒发一下想对着太空说的话。也可以惊喜地看到别人写的漂流瓶。</p>

<h4 id="b-来个更逼真的lbsar游戏">b. 来个更逼真的LBS+AR游戏</h4>

<p>后续希望可以从用户拍的图片获取到地点或经纬度，或者用户发送定位来，从而实现更准确的LBS定位。叠加上AI图像能力，说不定能比PokemonGo更棒噢！</p>

<p>起码<strong>普通伊布是不应该在水面出现的噢 @任天堂</strong>。</p>

<p><img src="/assets/2021/08-super-interstellar-terminal/last1.webp" alt="last1" /></p>

<p>看到这个项目，要不要也一起合作来把AI融到游戏里啊 @任天堂 （JUST JOKING. DON’T TAKE IT SERIOUSELY.)</p>

<h4 id="c-来更多脑洞一起创作玩法与剧本吧">c. 来更多脑洞一起创作玩法与剧本吧</h4>

<p>希望更多有兴趣的脑洞，一起想想我们可以怎么玩，让我们玩得更high一点吧！</p>

<h3 id="e2-期盼">E.2 期盼</h3>

<p>希望更多小伙伴能贡献一下自己的脑洞，基于此项目，觉得还可以优化的游戏方式或游戏剧本。希望留言或评论。感谢！</p>

<p>希望小伙伴们觉得此项目不错的<strong>点个赞（Star）和Fork</strong>。能从头看到这里的很不容易了。非常感谢！！</p>

<h3 id="e3-reference参考内容">E.3 Reference/参考内容</h3>

<ul>
  <li>
    <p><a href="https://account.aliyun.com">阿里云官网</a></p>
  </li>
  <li>
    <p><a href="https://wechaty.js.org">Wechaty官网</a></p>
  </li>
  <li>
    <p><a href="https://github.com/wechaty/python-wechaty">python-wechaty</a></p>
  </li>
  <li>
    <p><a href="https://github.com/wechaty/python-wechaty-getting-started">python-wechaty-getting-started</a></p>
  </li>
  <li>
    <p><a href="https://aistudio.baidu.com/aistudio/projectdetail/1836012">教你用AI Studio+Wechaty+阿里云白嫖一个智能微信机器人</a></p>
  </li>
  <li>
    <p><a href="http://https://aistudio.baidu.com/aistudio/projectdetail/1936908">通过LSGAN以及WGAN-GP实现128*128大小的喀纳斯风景图片</a></p>
  </li>
  <li>
    <p><a href="http://https://aistudio.baidu.com/aistudio/projectdetail/2210138">Paddle2.0-通过LSGAN让我们看看AI预测的外星人长什么样子</a></p>
  </li>
</ul>

<h3 id="e4-致谢">E.4 致谢</h3>

<ul>
  <li>感谢百度爸爸的算力及技术支持</li>
  <li>感谢Wechaty与Mixlabs</li>
  <li>感谢Reference中列到的所有作者</li>
  <li>感谢其中用到的所有开源项目的作者及维护者</li>
  <li>感谢Teammate<a href="https://github.com/Lovely-Pig">@Lovely-Pig</a>，感谢过程中所有提供鼓励与帮助的百度人员</li>
  <li>致敬为拓展人类的宇宙梦而奋斗的所有技术工作者 Respect！!!</li>
</ul>

			</article>

			<!-- Tags -->
			<div class="mb-4">
				<span class="taglist">
				
				  <a class="sscroll btn btn-light btn-sm font-weight-bold" href="/tags.html#blog">blog</a>
				
				  <a class="sscroll btn btn-light btn-sm font-weight-bold" href="/tags.html#ar">ar</a>
				
				  <a class="sscroll btn btn-light btn-sm font-weight-bold" href="/tags.html#game">game</a>
				
				  <a class="sscroll btn btn-light btn-sm font-weight-bold" href="/tags.html#introduction">introduction</a>
				
				</span>
			</div>

            <!-- Mailchimp Subscribe Form -->
            
			<div class="border p-5 bg-lightblue">
				<div class="row justify-content-between">
					<div class="col-md-6 mb-2 mb-md-0">
						<h5 class="font-weight-bold">Join Newsletter</h5>
						 Get the latest news right in your inbox. We never spam!
					</div>
					<div class="col-md-6">
						<div class="row">
              <form action="https://zixia.us4.list-manage.com/subscribe/post?u=a8584b55dea5aa8bbc14bd1a0&amp;id=d9899f0d70" method="post" name="mc-embedded-subscribe-form" class="wj-contact-form validate w-100" target="_blank" novalidate>
                <input type="email" placeholder="Enter e-mail address" name="EMAIL" class="required email form-control w-100" id="mce-EMAIL" autocomplete="on" required>
                <input type="text"  placeholder="Name"                 name="FNAME" class="required form-control w-100"       id="mce-FNAME" autocomplete="on" required>
                <button type="submit" value="Subscribe" name="subscribe" class="heart btn btn-success btn-block w-100 mt-2">Subscribe</button>
              </form>
						</div>
					</div>
				</div>
			</div>
            


             <!-- Author Box -->
                
				<div class="row mt-5">
					<div class="col-md-2 align-self-center">
                        
                          <a href="/contributors/kevinfu1717">
                            <img class="rounded-circle" src="/assets/contributors/kevinfu1717/avatar.webp" alt="kevinfu1717" width="90"/>
                          </a>
                        
					</div>
					<div class="col-md-10">
                        <h5 class="font-weight-bold">Written by <a href="/contributors/kevinfu1717">kevinfu1717</a> </h5>
						一个华师毕业的光学研究僧
					</div>
				</div>
                

            <!-- Comments -->
            
                <!--  Giscus embeds GitHub Discussions for per-post comments. Configuration intentionally hard-coded. -->

<div id="comments" class="mt-5">
    <script src="https://giscus.app/client.js"
            data-repo="wechaty/js.org"
            data-repo-id="R_kgDOHF4w6Q"
            data-category="General"
            data-category-id="DIC_kwDOHF4w6c4Cx6g7"
            data-mapping="pathname"
            data-strict="0"
            data-reactions-enabled="1"
            data-emit-metadata="1"
            data-input-position="bottom"
            data-theme="light"
            data-lang="en"
            crossorigin="anonymous"
            async>
    </script>
    <noscript>
        Comments require JavaScript. You can also join the discussion on our
        <a href="https://github.com/wechaty/js.org/discussions/categories/general" rel="noopener" target="_blank">GitHub Discussions</a> page.
    </noscript>
</div>

            

		</div>


	</div>
</div>


<!-- Aletbar Prev/Next -->
<div class="alertbar">
    <div class="container">
        <div class="row prevnextlinks small font-weight-bold">
          
            <div class="col-md-6 rightborder pl-0">
                <a class="text-dark" href="/2021/08/15/gsod-2021-eighth-meeting/"> <img height="30px" class="mr-1" src="https://wechaty.js.org/assets/2021/08-gsod-2021-eighth-meeting/gsod-eighth-meeting.webp">  GSoD'21 Eighth Meeting</a>
            </div>
          
          
            <div class="col-md-6 text-right pr-0">
                <a class="text-dark" href="/2021/08/25/future-wander-bot-001/"> Wander[001] - 未来流浪者：微信中的科幻机器人 V2.1  <img height="30px" class="ml-1" src="https://wechaty.js.org/assets/2021/08-future-wander-bot-001/conv1.webp"> </a>
            </div>
          
        </div>
    </div>
</div>

    </main>


    <!-- Scripts: popper, bootstrap, theme, lunr -->
    <script src="https://cdnjs.loli.net/ajax/libs/popper.js/1.14.6/umd/popper.min.js" crossorigin="anonymous"></script>

    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/js/bootstrap.min.js" crossorigin="anonymous"></script>

    <script src="/assets/js/theme.js"></script>

  





    <!-- Footer -->
    <footer class="bg-white border-top p-3 text-muted small">
        <div class="container">
        <div class="row align-items-center justify-content-between">
            <div>
                <a href="#" class="text-muted navbar-brand mr-2 mb-0">
                  <strong>Wechaty</strong>
                </a>
                <span>Copyright © <script>document.write(new Date().getFullYear())</script></span>
                |
                <a
                  class="text-muted"
                  target="_blank"
                  href="/branding/"
                >
                  Branding
                </a>

                <!--  Github Repo Star Btn-->
                <a class="text-dark ml-1" target="_blank" href="https://github.com/wechaty"><i class="fab fa-github"></i> </a>

            </div>

            <div class="text-gray">
              Powered by
              <a
                class="text-gray font-weight-bold"
                target="_blank"
                href="https://www.wowthemes.net/mundana-jekyll-theme/"
              >
                Mundana Jekyll Theme
              </a>
              .
            </div>
        </div>
        </div>
    </footer>

    <!-- All this area goes before             <script>
                window.onload = function () {
                    var script = document.createElement('script');
                    var firstScript = document.getElementsByTagName('script')[0];
                    script.type = 'text/javascript';
                    script.async = true;
                    script.src = '/sw-register.js?v=' + Date.now();
                    firstScript.parentNode.insertBefore(script, firstScript);
                };
            </script>
            </body>
 closing tag -->


</body>

</html>
