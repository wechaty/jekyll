<!DOCTYPE html>
<html lang="en">
<head>
    <!-- https://github.com/t-richards/jekyll-google-tag-manager -->
    <!-- Begin Jekyll GTM tag v1.0.3 -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-PD2PL84');</script>
<!-- End Jekyll GTM tag v1.0.3 -->


    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">

    

    <title>
      Integrate Wechat Personal Account to Microsoft BotFramework with a BotBuilder Wechaty Connector | Wechaty
    </title>

    <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Integrate Wechat Personal Account to Microsoft BotFramework with a BotBuilder Wechaty Connector | Wechaty</title>
<meta name="generator" content="Jekyll v4.4.1" />
<meta property="og:title" content="Integrate Wechat Personal Account to Microsoft BotFramework with a BotBuilder Wechaty Connector" />
<meta name="author" content="huan" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Conversational RPA SDK for Chatbot Makers" />
<meta property="og:description" content="Conversational RPA SDK for Chatbot Makers" />
<link rel="canonical" href="https://wechaty.js.org/2018/04/18/botbuilder-wechaty-connector/" />
<meta property="og:url" content="https://wechaty.js.org/2018/04/18/botbuilder-wechaty-connector/" />
<meta property="og:site_name" content="Wechaty" />
<meta property="og:image" content="https://wechaty.js.org/assets/2018/botframework.webp" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2018-04-18T00:00:00+00:00" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="twitter:image" content="https://wechaty.js.org/assets/2018/botframework.webp" />
<meta property="twitter:title" content="Integrate Wechat Personal Account to Microsoft BotFramework with a BotBuilder Wechaty Connector" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"huan"},"dateModified":"2018-04-18T00:00:00+00:00","datePublished":"2018-04-18T00:00:00+00:00","description":"Conversational RPA SDK for Chatbot Makers","headline":"Integrate Wechat Personal Account to Microsoft BotFramework with a BotBuilder Wechaty Connector","image":"https://wechaty.js.org/assets/2018/botframework.webp","mainEntityOfPage":{"@type":"WebPage","@id":"https://wechaty.js.org/2018/04/18/botbuilder-wechaty-connector/"},"publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"https://wechaty.js.org/assets/images/logo.png"},"name":"huan"},"url":"https://wechaty.js.org/2018/04/18/botbuilder-wechaty-connector/"}</script>
<!-- End Jekyll SEO tag -->


    <link rel="shortcut icon" type="image/x-icon" href="/assets/images/favicon.ico">

    <link rel="manifest" href="/manifest.json">

    <!-- Font Awesome Icons -->
    <link rel="stylesheet" href="https://s3.pstatp.com/cdn/expire-1-M/font-awesome/5.3.1/css/all.css" crossorigin="anonymous">

    <!-- Google Fonts in China Thanks @crossly @sidny -->
    <link href="https://fonts.loli.net/css?family=Lora" rel="stylesheet">

    <!-- Bootstrap Modified -->
    <link rel="stylesheet" href="/assets/css/main.css">

    <!-- Theme Stylesheet -->
    <link rel="stylesheet" href="/assets/css/theme.css">

    <!-- Highlight Stylesheet -->
    <link rel="stylesheet" href="/assets/css/highlight.css">

    <!-- Jquery on header to make sure everything works, the rest  of the scripts in footer for fast loading -->
    <script
    src="https://s0.pstatp.com/cdn/expire-1-M/jquery/3.3.1/jquery.min.js"
    integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
    crossorigin="anonymous"></script>

</head>

<body class="">
    <!-- https://github.com/t-richards/jekyll-google-tag-manager -->
    <!-- Begin Jekyll GTM tag v1.0.3 (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-PD2PL84"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Jekyll GTM tag v1.0.3 (noscript) -->


    <!-- Navbar -->
    <nav id="MagicMenu" class="topnav navbar navbar-expand-lg navbar-light bg-white fixed-top">
    <div class="container">
        <a class="navbar-brand" href="/"><strong>Wechaty</strong></a>
        <button class="navbar-toggler collapsed" type="button" data-toggle="collapse" data-target="#navbarColor02" aria-controls="navbarColor02" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
        </button>
        <div class="navbar-collapse collapse" id="navbarColor02">
            <ul class="navbar-nav mr-auto d-flex align-items-center">
               <!--  Replace menu links here -->

<li class="nav-item">
  <a class="nav-link" href="/news/">News</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="/blog/">Blog</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="/docs/">Docs</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="/contributors/">Contributors</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="https://github.com/wechaty/PMC#wechaty-committers" target="_blank">Talks</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="https://github.com/wechaty/wechaty#readme" target="_blank">GitHub</a>
</li>


            </ul>
            <ul class="navbar-nav ml-auto d-flex align-items-center">
                <li class="nav-item">
                  <a class="nav-link" href="/search/">Search</a>
                </li>
            </ul>
        </div>
    </div>
    </nav>

  <!-- Search results moved to a dedicated /search page -->

    <!-- Content -->
    <main role="main" class="site-content">
        

<div class="container">
<div class="jumbotron jumbotron-fluid mb-3 pl-0 pt-0 pb-0 bg-white position-relative">
		<div class="h-100 tofront">
			<div class="row  justify-content-between ">
				<div class=" col-md-6  pr-0 pr-md-4 pt-4 pb-4 align-self-center">
					<p class="text-uppercase font-weight-bold">
            <span class="catlist">

            
              <a class="sscroll text-danger" href="/categories.html#npm">npm</a><span class="sep">, </span>
            

            </span>
					</p>
					<h1 class="display-4 mb-4 article-headline">Integrate Wechat Personal Account to Microsoft BotFramework with a BotBuilder Wechaty Connector</h1>
					<div class="d-flex align-items-center">
                        
                          <a href="/contributors/huan">
                            <img class="rounded-circle" src="/assets/contributors/huan/avatar.webp" alt="Huan Li" width="70"/>
                          </a>
                        
						<small class="ml-3"> Huan Li <span><a target="_blank" href="https://twitter.com/huan2024" class="btn btn-outline-success btn-sm btn-round ml-1">Follow</a></span>
                            <span class="text-muted d-block mt-1">Apr 18, 2018 Â· <span class="reading-time">
  
  
    3 mins read
  
</span>
</span>
						</small>
					</div>
				</div>
                
				<div class="col-md-6 pr-0 align-self-center">
					<img class="rounded" src="/assets/2018/botframework.webp" alt="Integrate Wechat Personal Account to Microsoft BotFramework with a BotBuilder Wechaty Connector">
				</div>
                
			</div>
		</div>
	</div>
</div>





<div class="container-lg pt-4 pb-4">
	<div class="row justify-content-center">

    <!-- Share -->
<div class="col-lg-2 pr-4 mb-5 col-md-12">
  <div class="sticky-top sticky-top-offset text-center">
    <div class="text-muted">
    </div>
    <div class="share d-inline-block">
      <!-- AddToAny BEGIN -->
      <div class="a2a_kit a2a_kit_size_32 a2a_default_style">
        <a class="a2a_button_wechat" title='Wechat'>
          <img id="qrcode" title="Wechat"
            src="/assets/contributors/wechaty/icon.png"
            width="64" height="64"
          />
        </a>
        <a class="a2a_button_wechat" title='Wechat'></a>
        <a class="a2a_button_sina_weibo" title='Weibo'></a>
        <a class="a2a_button_linkedin" title='LinkedIn'></a>
        <a class="a2a_button_facebook" title='FaceBook'></a>
        <a class="a2a_button_twitter" title='Twitter'></a>
        <a class="a2a_dd" href="https://www.addtoany.com/share"></a>
        <!-- AddToAny BEGIN -->
      </div>
      <script async src="https://static.addtoany.com/menu/page.js"></script>
      <!-- AddToAny END -->
    </div>
  </div>
</div>

<script>
  var href = document.location.href
  var url = 'https://api.qrserver.com/v1/create-qr-code/?data='
            + href
            + '&size=512x512'
  var img = document.getElementById('qrcode')

  img.src=encodeURI(url)
</script>


		<div class="col-md-12 col-lg-8">

      <!-- Article -->
			<article class="article-post">
			<p><img src="/assets/2018/botframework.webp" alt="BotFramework" /></p>

<p><a href="https://dev.botframework.com/">Microsoft BotFramework</a> is a robust platform that supports almost all kinds of the instance messengers like Facebook messenger, Skype, Slack, and backed by the powerful Cognitive Services like LUIS.ai, QnAMaker.ai, Azure Machine Learning. BotBuilder is a powerful SDK provides all we need when we are developing a ChatBot. I started learning them about 18 months ago, and I love them very much.</p>

<p>However, it does not support Wechat <strong>Individual</strong> Account, so I decided to make some fun on it: connect Wechat PERSONAL Account to the BotBuilder by creating a new Connector: <a href="https://github.com/huan/botbuilder-wechaty-connector">botbuilder-wechaty-connector</a>.</p>

<h2 id="update">Update</h2>

<ul>
  <li>Jan 14, 2019: The <a href="https://npmjs.com/package/botbuilder-wechaty-adapter">botbuilder-wechaty-adapter</a> realeased for Bot Builder V4 support.</li>
  <li>Apr 18, 2018: The <a href="https://npmjs.com/package/botbuilder-wechaty-connector">botbuilder-wechaty-connecter</a> realeased for Bot Builder V3 support.)</li>
</ul>

<p>The Connector is a bridge between the BotBuilder and the Instance Messenger, in our case, Wechat.</p>

<p>Thereâs some document at <a href="https://docs.botframework.com/en-us/node/builder/chat-reference/interfaces/_botbuilder_d_.iconnector.html">Bot Builder for Node.js
Libraries - Interface IConnector</a> with two examples: <code class="language-plaintext highlighter-rouge">ChatConnector</code> and <code class="language-plaintext highlighter-rouge">ConsoleConnector</code>. However, I found the most useful example is a Wechat Official Account Connector: <a href="https://github.com/jyfcrw/botbuilder-wechat-connector">https://github.com/jyfcrw/botbuilder-wechat-connector</a> whose code is concise and clean, so I decided to start from here.</p>

<p>Itâs not very difficult for me to replace the two NPM module <code class="language-plaintext highlighter-rouge">wechat</code> &amp; <code class="language-plaintext highlighter-rouge">wechat-api</code> to <code class="language-plaintext highlighter-rouge">wechaty</code>, and rewrite all the code to TypeScript, then add linting &amp; testing, setup DevOps CI/CD to publish on NPM. It takes me about three hours to finish them.</p>

<p>Contract to the Wechat Official Account, Personal Account will be very easy to start because you only need to scan the QR code on the phone to log in instead of register an official account with APP_ID &amp; APP_SECRET.</p>

<p>The following code simple setup a connector between BotBuilder and Wechat, ask and answer elementary questions:</p>

<ol>
  <li>Whatâs your name?</li>
  <li>OK, ${your name}</li>
  <li>Whatâs your age?</li>
  <li>All right, ${your age}</li>
  <li>How are you, ${your name}</li>
</ol>

<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="o">*</span> <span class="kd">as </span><span class="nx">builder</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">botbuilder</span><span class="dl">'</span>

<span class="k">import</span> <span class="p">{</span> <span class="nx">WechatyConnector</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">botbuilder-wechaty-connector</span><span class="dl">'</span>

<span class="c1">// Create wechat personal account connector</span>
<span class="kd">const</span> <span class="nx">wechatyConnector</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">WechatyConnector</span><span class="p">()</span>

<span class="kd">const</span> <span class="nx">bot</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">builder</span><span class="p">.</span><span class="nc">UniversalBot</span><span class="p">(</span><span class="nx">wechatyConnector</span><span class="p">)</span>

<span class="c1">// Bot dialogs</span>
<span class="nx">bot</span><span class="p">.</span><span class="nf">dialog</span><span class="p">(</span><span class="dl">'</span><span class="s1">/</span><span class="dl">'</span><span class="p">,</span> <span class="p">[</span>
  <span class="nf">function </span><span class="p">(</span><span class="nx">session</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if </span><span class="p">(</span><span class="nx">session</span><span class="p">.</span><span class="nx">userData</span> <span class="o">&amp;&amp;</span> <span class="nx">session</span><span class="p">.</span><span class="nx">userData</span><span class="p">.</span><span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">session</span><span class="p">.</span><span class="nf">send</span><span class="p">(</span><span class="dl">'</span><span class="s1">How are you, </span><span class="dl">'</span> <span class="o">+</span> <span class="nx">session</span><span class="p">.</span><span class="nx">userData</span><span class="p">.</span><span class="nx">name</span><span class="p">)</span>
      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nx">builder</span><span class="p">.</span><span class="nx">Prompts</span><span class="p">.</span><span class="nf">text</span><span class="p">(</span><span class="nx">session</span><span class="p">,</span> <span class="dl">'</span><span class="s1">Whats your name?</span><span class="dl">'</span><span class="p">)</span>
      <span class="p">}</span>
  <span class="p">},</span>
  <span class="nf">function </span><span class="p">(</span><span class="nx">session</span><span class="p">,</span> <span class="nx">results</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">session</span><span class="p">.</span><span class="nx">userData</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="nx">results</span><span class="p">.</span><span class="nx">response</span>
      <span class="nx">session</span><span class="p">.</span><span class="nf">send</span><span class="p">(</span><span class="dl">'</span><span class="s1">OK, </span><span class="dl">'</span> <span class="o">+</span> <span class="nx">session</span><span class="p">.</span><span class="nx">userData</span><span class="p">.</span><span class="nx">name</span><span class="p">)</span>
      <span class="nx">builder</span><span class="p">.</span><span class="nx">Prompts</span><span class="p">.</span><span class="nf">text</span><span class="p">(</span><span class="nx">session</span><span class="p">,</span> <span class="dl">'</span><span class="s1">Whats your age?</span><span class="dl">'</span><span class="p">)</span>
  <span class="p">},</span>
  <span class="nf">function </span><span class="p">(</span><span class="nx">session</span><span class="p">,</span> <span class="nx">results</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">session</span><span class="p">.</span><span class="nx">userData</span><span class="p">.</span><span class="nx">age</span> <span class="o">=</span> <span class="nx">results</span><span class="p">.</span><span class="nx">response</span>
      <span class="nx">session</span><span class="p">.</span><span class="nf">send</span><span class="p">(</span><span class="dl">'</span><span class="s1">All right, </span><span class="dl">'</span> <span class="o">+</span> <span class="nx">results</span><span class="p">.</span><span class="nx">response</span><span class="p">)</span>
  <span class="p">},</span>
<span class="p">])</span>

<span class="nx">wechatyConnector</span><span class="p">.</span><span class="nf">listen</span><span class="p">()</span>
</code></pre></div></div>

<blockquote>
  <p>The above example is borrowed from <code class="language-plaintext highlighter-rouge">botbuilder-wechat-connector</code>.</p>
</blockquote>

<p>Hope you will like it and could make fun of it too, cheers!</p>

<h2 id="see-also">See Also</h2>

<ul>
  <li>GitHub: <a href="https://github.com/huan/botbuilder-wechaty-connector">https://github.com/huan/botbuilder-wechaty-connector</a></li>
  <li>NPM: <a href="https://www.npmjs.com/package/botbuilder-wechaty-connector">https://www.npmjs.com/package/botbuilder-wechaty-connector</a></li>
  <li><a href="https://docs.microsoft.com/en-us/azure/bot-service/nodejs/bot-builder-nodejs-quickstart">Create a bot with the Bot Builder SDK for Node.js</a></li>
  <li><a href="https://docs.microsoft.com/en-us/azure/bot-service/nodejs/bot-builder-nodejs-concepts">Key concepts in the Bot Builder SDK for Node.js</a></li>
  <li><a href="https://pusher.com/sessions/meetup/dotnetsheff/become-a-bot-builder-with-microsoft-bot-framework">VIDEO: Become a Bot Builder with Microsoft Bot Framework - James Mann speaking at dotnetsheff in April, 2017</a></li>
</ul>

			</article>

			<!-- Tags -->
			<div class="mb-4">
				<span class="taglist">
				
				  <a class="sscroll btn btn-light btn-sm font-weight-bold" href="/tags.html#botbuilder">botbuilder</a>
				
				  <a class="sscroll btn btn-light btn-sm font-weight-bold" href="/tags.html#featured">featured</a>
				
				</span>
			</div>

            <!-- Mailchimp Subscribe Form -->
            
			<div class="border p-5 bg-lightblue">
				<div class="row justify-content-between">
					<div class="col-md-6 mb-2 mb-md-0">
						<h5 class="font-weight-bold">Join Newsletter</h5>
						 Get the latest news right in your inbox. We never spam!
					</div>
					<div class="col-md-6">
						<div class="row">
              <form action="https://zixia.us4.list-manage.com/subscribe/post?u=a8584b55dea5aa8bbc14bd1a0&amp;id=d9899f0d70" method="post" name="mc-embedded-subscribe-form" class="wj-contact-form validate w-100" target="_blank" novalidate>
                <input type="email" placeholder="Enter e-mail address" name="EMAIL" class="required email form-control w-100" id="mce-EMAIL" autocomplete="on" required>
                <input type="text"  placeholder="Name"                 name="FNAME" class="required form-control w-100"       id="mce-FNAME" autocomplete="on" required>
                <button type="submit" value="Subscribe" name="subscribe" class="heart btn btn-success btn-block w-100 mt-2">Subscribe</button>
              </form>
						</div>
					</div>
				</div>
			</div>
            


             <!-- Author Box -->
                
				<div class="row mt-5">
					<div class="col-md-2 align-self-center">
                        
                          <a href="/contributors/huan">
                            <img class="rounded-circle" src="/assets/contributors/huan/avatar.webp" alt="Huan Li" width="90"/>
                          </a>
                        
					</div>
					<div class="col-md-10">
                        <h5 class="font-weight-bold">Written by Huan Li <span><a target="_blank" href="https://twitter.com/huan2024" class="btn btn-outline-success btn-sm btn-round ml-2">Follow</a></span></h5>
						Author @ Wechaty, Architect @ Chatie, LLM Code Generation Enthusiast, Serial Entrepreneur, Burnerð¥
					</div>
				</div>
                

            <!-- Comments -->
            
                <!--  Don't edit anything here. Set your disqus id in _config.yml -->

<div id="comments" class="mt-5">
    <div id="disqus_thread">
    </div>
    <script type="text/javascript">
        var disqus_shortname = 'wechaty'; 
        var disqus_developer = 0;
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = window.location.protocol + '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>
    Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a>
    </noscript>
</div>
            

		</div>


	</div>
</div>


<!-- Aletbar Prev/Next -->
<div class="alertbar">
    <div class="container">
        <div class="row prevnextlinks small font-weight-bold">
          
            <div class="col-md-6 rightborder pl-0">
                <a class="text-dark" href="/2018/03/10/wechat-protocol-reference-guide/"> <img height="30px" class="mr-1" src="https://wechaty.js.org/assets/2018/h4dex-wechatprotocol.webp">  å¾®ä¿¡Appéä¿¡åè®®æ¡ä¾å­¦ä¹ åèæå</a>
            </div>
          
          
            <div class="col-md-6 text-right pr-0">
                <a class="text-dark" href="/2018/04/23/blessed-twins-bot/"> New Feature: Multi-Instance Support for Wechaty v0.16(WIP)  <img height="30px" class="ml-1" src="https://wechaty.js.org/assets/2018/blessed-twins-bot.webp"> </a>
            </div>
          
        </div>
    </div>
</div>

    </main>


    <!-- Scripts: popper, bootstrap, theme, lunr -->
    <script src="https://cdnjs.loli.net/ajax/libs/popper.js/1.14.6/umd/popper.min.js" crossorigin="anonymous"></script>

    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/js/bootstrap.min.js" crossorigin="anonymous"></script>

    <script src="/assets/js/theme.js"></script>


    <!-- Footer -->
    <footer class="bg-white border-top p-3 text-muted small">
        <div class="container">
        <div class="row align-items-center justify-content-between">
            <div>
                <a href="#" class="text-muted navbar-brand mr-2 mb-0">
                  <strong>Wechaty</strong>
                </a>
                <span>Copyright Â© <script>document.write(new Date().getFullYear())</script></span>
                |
                <a
                  class="text-muted"
                  target="_blank"
                  href="/branding/"
                >
                  Branding
                </a>

                <!--  Github Repo Star Btn-->
                <a class="text-dark ml-1" target="_blank" href="https://github.com/wechaty"><i class="fab fa-github"></i> </a>

            </div>

            <div class="text-gray">
              Powered by
              <a
                class="text-gray font-weight-bold"
                target="_blank"
                href="https://www.wowthemes.net/mundana-jekyll-theme/"
              >
                Mundana Jekyll Theme
              </a>
              .
            </div>
        </div>
        </div>
    </footer>

    <!-- All this area goes before             <script>
                window.onload = function () {
                    var script = document.createElement('script');
                    var firstScript = document.getElementsByTagName('script')[0];
                    script.type = 'text/javascript';
                    script.async = true;
                    script.src = '/sw-register.js?v=' + Date.now();
                    firstScript.parentNode.insertBefore(script, firstScript);
                };
            </script>
            </body>
 closing tag -->


</body>

</html>
