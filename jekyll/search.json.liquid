---
layout: null
permalink: /search.json
sitemap: false
---
{%- comment -%}
Generate a single JSON index for client-side search.
Quotes everything via `jsonify` and avoids trailing commas.
Excludes the generator page itself.
{%- endcomment -%}
{%- assign candidates = site.posts | concat: site.pages -%}
{%- assign docs = candidates | where_exp: "d", "d.search != false" -%}
{%- assign docs = docs | where_exp: "d", "d.hidden != true" -%}
{%- assign docs = docs | where_exp: "d", "d.url != '/search.json'" -%}
{
  "docs": [
  {%- for d in docs -%}
    {%- assign title = d.title | default: d.name | default: d.url -%}
    {
      "title": {{ title | jsonify }},
      "url": {{ d.url | relative_url | jsonify }},
      "tags": {{ d.tags | jsonify }},
      "categories": {{ d.categories | jsonify }},
  "excerpt": {{ d.excerpt | default: d.content | strip_html | normalize_whitespace | truncate: 220 | jsonify }}
    }{%- unless forloop.last -%},{%- endunless -%}
  {%- endfor -%}
  ]
}
