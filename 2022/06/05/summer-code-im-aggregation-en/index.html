<!DOCTYPE html>
<html lang="en">
<head>
    <!-- https://github.com/t-richards/jekyll-google-tag-manager -->
    <!-- Begin Jekyll GTM tag v1.0.3 -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-PD2PL84');</script>
<!-- End Jekyll GTM tag v1.0.3 -->


    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">

    

    <title>
      Summer of Code - IM Message Aggregation | Wechaty
    </title>

    <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Summer of Code - IM Message Aggregation | Wechaty</title>
<meta name="generator" content="Jekyll v4.4.1" />
<meta property="og:title" content="Summer of Code - IM Message Aggregation" />
<meta name="author" content="tanknee" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="A Summer of Code project to aggregate messages from different IM applications (WeChat, WeCom, WhatsApp) and forward them at scheduled times to reduce information overload and improve productivity." />
<meta property="og:description" content="A Summer of Code project to aggregate messages from different IM applications (WeChat, WeCom, WhatsApp) and forward them at scheduled times to reduce information overload and improve productivity." />
<link rel="canonical" href="https://wechaty.js.org/2022/06/05/summer-code-im-aggregation-en/" />
<meta property="og:url" content="https://wechaty.js.org/2022/06/05/summer-code-im-aggregation-en/" />
<meta property="og:site_name" content="Wechaty" />
<meta property="og:image" content="https://wechaty.js.org/assets/2022/06-summer-code-im-aggregation-en/title.webp" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2022-06-05T00:00:00+00:00" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="twitter:image" content="https://wechaty.js.org/assets/2022/06-summer-code-im-aggregation-en/title.webp" />
<meta property="twitter:title" content="Summer of Code - IM Message Aggregation" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"tanknee"},"dateModified":"2022-06-05T00:00:00+00:00","datePublished":"2022-06-05T00:00:00+00:00","description":"A Summer of Code project to aggregate messages from different IM applications (WeChat, WeCom, WhatsApp) and forward them at scheduled times to reduce information overload and improve productivity.","headline":"Summer of Code - IM Message Aggregation","image":"https://wechaty.js.org/assets/2022/06-summer-code-im-aggregation-en/title.webp","mainEntityOfPage":{"@type":"WebPage","@id":"https://wechaty.js.org/2022/06/05/summer-code-im-aggregation-en/"},"publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"https://wechaty.js.org/assets/images/logo.png"},"name":"tanknee"},"url":"https://wechaty.js.org/2022/06/05/summer-code-im-aggregation-en/"}</script>
<!-- End Jekyll SEO tag -->


    <link rel="shortcut icon" type="image/x-icon" href="/assets/images/favicon.ico">

    <link rel="manifest" href="/manifest.json">

    <!-- Font Awesome Icons -->
    <link rel="stylesheet" href="https://s3.pstatp.com/cdn/expire-1-M/font-awesome/5.3.1/css/all.css" crossorigin="anonymous">

    <!-- Google Fonts in China Thanks @crossly @sidny -->
    <link href="https://fonts.loli.net/css?family=Lora" rel="stylesheet">

    <!-- Bootstrap Modified -->
    <link rel="stylesheet" href="/assets/css/main.css">

    <!-- Theme Stylesheet -->
    <link rel="stylesheet" href="/assets/css/theme.css">

    <!-- Highlight Stylesheet -->
    <link rel="stylesheet" href="/assets/css/highlight.css">

    <!-- Jquery on header to make sure everything works, the rest  of the scripts in footer for fast loading -->
    <script
    src="https://s0.pstatp.com/cdn/expire-1-M/jquery/3.3.1/jquery.min.js"
    integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
    crossorigin="anonymous"></script>

    




</head>

<body class="">
    <!-- https://github.com/t-richards/jekyll-google-tag-manager -->
    <!-- Begin Jekyll GTM tag v1.0.3 (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-PD2PL84"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Jekyll GTM tag v1.0.3 (noscript) -->


    <!-- Navbar -->
    <nav id="MagicMenu" class="topnav navbar navbar-expand-lg navbar-light bg-white fixed-top">
    <div class="container">
        <a class="navbar-brand" href="/"><strong>Wechaty</strong></a>
        <button class="navbar-toggler collapsed" type="button" data-toggle="collapse" data-target="#navbarColor02" aria-controls="navbarColor02" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
        </button>
        <div class="navbar-collapse collapse" id="navbarColor02">
            <ul class="navbar-nav mr-auto d-flex align-items-center">
               <!--  Replace menu links here -->

<li class="nav-item">
  <a class="nav-link" href="/news/">News</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="/blog/">Blog</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="https://ship.fail" target="_blank">Ship.Fail</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="https://preangel.ai" target="_blank">PreAngel.AI</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="/docs/">Docs</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="/contributors/">Contributors</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="https://github.com/wechaty/PMC#wechaty-committers" target="_blank">Talks</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="https://github.com/wechaty/wechaty#readme" target="_blank">GitHub</a>
</li>


            </ul>
            <ul class="navbar-nav ml-auto d-flex align-items-center">
                <li class="nav-item">
                  <a class="nav-link" href="/search/">Search</a>
                </li>
            </ul>
        </div>
    </div>
    </nav>

  <!-- Search results moved to a dedicated /search page -->

    <!-- Content -->
    <main role="main" class="site-content">
        

<div class="container">
<div class="jumbotron jumbotron-fluid mb-3 pl-0 pt-0 pb-0 bg-white position-relative">
		<div class="h-100 tofront">
			<div class="row  justify-content-between ">
				<div class=" col-md-6  pr-0 pr-md-4 pt-4 pb-4 align-self-center">
					<p class="text-uppercase font-weight-bold">
            <span class="catlist">

            
              <a class="sscroll text-danger" href="/categories.html#project">project</a><span class="sep">, </span>
            

            </span>
					</p>
					<h1 class="display-4 mb-4 article-headline">Summer of Code - IM Message Aggregation</h1>
					<div class="d-flex align-items-center">
                        
                          <a href="/contributors/tanknee">
                            <img class="rounded-circle" src="/assets/contributors/tanknee/avatar.webp" alt="TankNee" width="70"/>
                          </a>
                        
						<small class="ml-3"> <a href="/contributors/tanknee">TankNee</a> <span><a target="_blank" href="" class="btn btn-outline-success btn-sm btn-round ml-1">Follow</a></span>
                            <span class="text-muted d-block mt-1">Jun 05, 2022 · <span class="reading-time">
  
  
    5 mins read
  
</span>
</span>
						</small>
					</div>
				</div>
                
				<div class="col-md-6 pr-0 align-self-center">
					<img class="rounded" src="/assets/2022/06-summer-code-im-aggregation-en/title.webp" alt="Summer of Code - IM Message Aggregation">
				</div>
                
			</div>
		</div>
	</div>
</div>





<div class="container-lg pt-4 pb-4">
	<div class="row justify-content-center">

    <!-- Share -->
<div class="col-lg-2 pr-4 mb-5 col-md-12">
  <div class="sticky-top sticky-top-offset text-center">
    <div class="text-muted">
    </div>
    <div class="share d-inline-block">
      <!-- AddToAny BEGIN -->
      <div class="a2a_kit a2a_kit_size_32 a2a_default_style">
        <img id="qrcode" title="Wechat"
          src="/assets/contributors/wechaty/icon.png"
          width="64" height="64"
        />
        <a class="a2a_button_twitter" title='Twitter'></a>
        <a class="a2a_button_linkedin" title='LinkedIn'></a>
        <a class="a2a_button_facebook" title='FaceBook'></a>
        <a class="a2a_dd" href="https://www.addtoany.com/share"></a>
      </div>
      <script async src="https://static.addtoany.com/menu/page.js"></script>
      <!-- AddToAny END -->
    </div>
  </div>
</div>

<script>
  var href = document.location.href
  var url = 'https://api.qrserver.com/v1/create-qr-code/?data='
            + href
            + '&size=512x512'
  var img = document.getElementById('qrcode')

  img.src=encodeURI(url)
</script>


		<div class="col-md-12 col-lg-8">

      <!-- Article -->
			<article class="article-post">
			<blockquote>
  <p>This is a translated version of the original Chinese post. You can find the original post <a href="/2022/06/05/summer-code-im-aggregation/">here</a>.</p>
</blockquote>

<p>Nowadays, the types of social applications are becoming increasingly diverse. Everyone faces massive amounts of information daily, while attention and time are limited. Frequently browsing, checking, and replying to messages on various social platforms consumes a lot of energy. To improve work efficiency and reduce invalid information interference, we hope to aggregate messages from different IM applications (such as WeChat, WeCom, and WhatsApp) and forward all messages from the previous cycle to a specified application at fixed times each day.</p>

<h2 id="im-message-aggregation-application-function-overview">IM Message Aggregation Application Function Overview</h2>

<h3 id="integrating-wechat-wecom-and-whatsapp-through-wechaty">Integrating WeChat, WeCom, and WhatsApp Through Wechaty</h3>

<ul>
  <li>
    <p>Use Wechaty’s capabilities to implement sending and receiving basic message types for these three types of social apps</p>

    <ul>
      <li>Text messages</li>
      <li>Image messages</li>
      <li>File messages</li>
      <li>Animated emojis</li>
      <li>Card links</li>
    </ul>
  </li>
</ul>

<h3 id="message-interoperability-between-the-three-applications">Message Interoperability Between the Three Applications</h3>

<ul>
  <li>Through message forwarding and scheduling scheme, WeCom and WhatsApp messages can be aggregated to WeChat</li>
  <li>Message synchronization: synchronize messages from other applications</li>
</ul>

<h3 id="support-time-period-selection-of-social-software-for-receiving-messages">Support Time-Period Selection of Social Software for Receiving Messages</h3>

<ul>
  <li>Support configuration to select any social software as the message aggregation application, select message receiving time, etc.</li>
  <li>Support quick project deployment with Docker</li>
  <li>Support more IM applications</li>
  <li>Support extending third-party applications, connecting bots, weather queries, and similar applications</li>
</ul>

<h2 id="message-forwarding-and-scheduling">Message Forwarding and Scheduling</h2>

<p>After reaching a user-specified time point, the message aggregation application automatically pulls historical messages from the storage pool and forwards them to the aggregation application.</p>

<p>The general process of forwarding and scheduling is as follows.</p>

<p><img src="/assets/2022/06-summer-code-im-aggregation-en/1.webp" alt="Message forwarding and scheduling process" /></p>

<p>To protect users’ privacy information, in principle, the message aggregation application should delete the originally stored messages by default after forwarding.</p>

<p>To enhance the usability of this part, messages can be filtered and processed in a targeted manner.</p>

<p>For example, when the application receives information that triggers pre-set rules:</p>

<ol>
  <li>Messages that @me</li>
  <li>Messages that successfully match regular expressions</li>
  <li>Messages from specified group chats</li>
  <li>Messages sent by specified friends</li>
  <li>Specific categories of messages (images, links, animated emojis, etc.)</li>
</ol>

<p>Then some custom operations can be performed, such as:</p>

<ol>
  <li>Send specified network requests</li>
  <li>Forward messages to a specified user</li>
  <li>Send emails to specified email addresses</li>
</ol>

<p>When forwarding messages to the aggregation application, an additional message needs to be sent to inform users which social application the following forwarded messages come from, for example (the following content is sent from WeChat).</p>

<h2 id="project-configuration">Project Configuration</h2>

<p>To make the user experience more consistent and avoid cumbersome configuration after starting the Docker service, users should configure the message aggregation application through conversational interaction operations in WeChat. We expect to be able to configure the following functions:</p>

<ol>
  <li>Aggregation application</li>
  <li>Message forwarding time (can be a sequence, multiple times)</li>
  <li>Whitelist mechanism (regular expressions, message types, @me and other multi-condition combinations)</li>
  <li>Blacklist mechanism</li>
  <li>Operations after keyword triggers</li>
  <li>Clear message pool</li>
  <li>Pause message forwarding through interactive commands</li>
  <li>Restart message forwarding through interactive operations</li>
</ol>

<p><img src="/assets/2022/06-summer-code-im-aggregation-en/2.webp" alt="Interactive operations" /></p>

<p>In addition to the above configuration-related content, the interactive operations should also support:</p>

<ol>
  <li>Query application status, such as whether the application is running, how many messages are in the message pool.</li>
  <li>Query whether accounts of other social applications are online.</li>
</ol>

<h2 id="extensions">Extensions</h2>

<h3 id="multi-im-application-integration">Multi-IM Application Integration</h3>

<p>This application should design a complete set of interfaces to facilitate developers and users to integrate more IM applications, such as Telegram, QQ, etc. The Wechaty community has already adapted many IM applications. We can perform simple adaptation of these applications, such as developing an adapter layer to unify data communication between puppets and the message aggregation application.</p>

<p><img src="/assets/2022/06-summer-code-im-aggregation-en/4.webp" alt="Message aggregation application architecture design" /></p>

<h3 id="third-party-application-integration">Third-Party Application Integration</h3>

<p>To enhance the playability and extensibility of the project, a plugin framework can be introduced. The application exposes several hook functions to plugins during its lifecycle, facilitating third-party developers to develop applications embedded in the message aggregation process.</p>

<p>Hooks can be roughly divided into these categories:</p>

<ol>
  <li>Project startup</li>
  <li>Receive messages</li>
  <li>Forward messages to aggregation application</li>
  <li>Receive commands from users</li>
</ol>

<p>As shown in the figure below, when the message aggregation application starts, it will trigger the callback functions of all extensions that have registered the “startup success” hook. When receiving IM messages, it will also trigger the callback functions of all extensions that have registered the “receive messages” hook. The other items follow similar logic.</p>

<p><img src="/assets/2022/06-summer-code-im-aggregation-en/3.webp" alt="Lifecycle events" /></p>

<p>Some messages that trigger keywords will be sent to third-party applications:</p>

<p><img src="/assets/2022/06-summer-code-im-aggregation-en/5.webp" alt="Interactive command events" /></p>

<h2 id="docker-image-packaging">Docker Image Packaging</h2>

<p>We plan to use Docker to integrate the runtime environment required by the project, facilitating users to quickly deploy the IM message aggregation project on their own machines or servers.</p>

<p>Docker related documentation: <a href="https://docs.docker.com/">https://docs.docker.com/</a>.</p>

<hr />

<h2 id="summary">Summary</h2>

<p>Since using Wechaty last year, I have been following Wechaty’s developments, thinking that after finishing the postgraduate entrance examination next year, I could do a wave of Wechaty’s <a href="https://summer-ospp.ac.cn/#/org/prodetail/220260301">Summer of Code</a> projects. What a coincidence, I managed to get it this year, so I’m very fortunate to be able to participate.</p>

<p>This project is planned to officially start construction in late June and early July. According to the workload described above, a rough product can be made in about a month. Around August, perfection and testing work will begin, along with writing related documentation.</p>

<blockquote>
  <p>This is a translated version of the original Chinese post. You can find the original post <a href="/2022/06/05/summer-code-im-aggregation/">here</a>.</p>
</blockquote>

			</article>

			<!-- Tags -->
			<div class="mb-4">
				<span class="taglist">
				
				  <a class="sscroll btn btn-light btn-sm font-weight-bold" href="/tags.html#summer-code">summer-code</a>
				
				  <a class="sscroll btn btn-light btn-sm font-weight-bold" href="/tags.html#puppet-whatsapp">puppet-whatsapp</a>
				
				  <a class="sscroll btn btn-light btn-sm font-weight-bold" href="/tags.html#productivity">productivity</a>
				
				</span>
			</div>

            <!-- Mailchimp Subscribe Form -->
            
			<div class="border p-5 bg-lightblue">
				<div class="row justify-content-between">
					<div class="col-md-6 mb-2 mb-md-0">
						<h5 class="font-weight-bold">Join Newsletter</h5>
						 Get the latest news right in your inbox. We never spam!
					</div>
					<div class="col-md-6">
						<div class="row">
              <form action="https://zixia.us4.list-manage.com/subscribe/post?u=a8584b55dea5aa8bbc14bd1a0&amp;id=d9899f0d70" method="post" name="mc-embedded-subscribe-form" class="wj-contact-form validate w-100" target="_blank" novalidate>
                <input type="email" placeholder="Enter e-mail address" name="EMAIL" class="required email form-control w-100" id="mce-EMAIL" autocomplete="on" required>
                <input type="text"  placeholder="Name"                 name="FNAME" class="required form-control w-100"       id="mce-FNAME" autocomplete="on" required>
                <button type="submit" value="Subscribe" name="subscribe" class="heart btn btn-success btn-block w-100 mt-2">Subscribe</button>
              </form>
						</div>
					</div>
				</div>
			</div>
            


             <!-- Author Box -->
                
				<div class="row mt-5">
					<div class="col-md-2 align-self-center">
                        
                          <a href="/contributors/tanknee">
                            <img class="rounded-circle" src="/assets/contributors/tanknee/avatar.webp" alt="TankNee" width="90"/>
                          </a>
                        
					</div>
					<div class="col-md-10">
                        <h5 class="font-weight-bold">Written by <a href="/contributors/tanknee">TankNee</a> </h5>
						ME
					</div>
				</div>
                

            <!-- Comments -->
            
                <!--  Giscus embeds GitHub Discussions for per-post comments. Configuration intentionally hard-coded. -->

<div id="comments" class="mt-5">
    <script src="https://giscus.app/client.js"
            data-repo="wechaty/js.org"
            data-repo-id="R_kgDOHF4w6Q"
            data-category="General"
            data-category-id="DIC_kwDOHF4w6c4Cx6g7"
            data-mapping="pathname"
            data-strict="0"
            data-reactions-enabled="1"
            data-emit-metadata="1"
            data-input-position="bottom"
            data-theme="light"
            data-lang="en"
            crossorigin="anonymous"
            async>
    </script>
    <noscript>
        Comments require JavaScript. You can also join the discussion on our
        <a href="https://github.com/wechaty/js.org/discussions/categories/general" rel="noopener" target="_blank">GitHub Discussions</a> page.
    </noscript>
</div>

            

		</div>


	</div>
</div>


<!-- Aletbar Prev/Next -->
<div class="alertbar">
    <div class="container">
        <div class="row prevnextlinks small font-weight-bold">
          
            <div class="col-md-6 rightborder pl-0">
                <a class="text-dark" href="/2022/05/26/wechaty-help-organize-football-activity/"> <img height="30px" class="mr-1" src="https://wechaty.js.org/assets/2022/05-wechaty-help-organize-football-activity-en/fozujinqun.webp">  Wechaty助力唐僧念经和佛祖踢球</a>
            </div>
          
          
            <div class="col-md-6 text-right pr-0">
                <a class="text-dark" href="/2022/06/05/summer-code-im-aggregation/"> 开源之夏 - IM 应用消息聚合  <img height="30px" class="ml-1" src="https://wechaty.js.org/assets/2022/06-summer-code-im-aggregation-en/title.webp"> </a>
            </div>
          
        </div>
    </div>
</div>

    </main>


    <!-- Scripts: popper, bootstrap, theme, lunr -->
    <script src="https://cdnjs.loli.net/ajax/libs/popper.js/1.14.6/umd/popper.min.js" crossorigin="anonymous"></script>

    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/js/bootstrap.min.js" crossorigin="anonymous"></script>

    <script src="/assets/js/theme.js"></script>

  





    <!-- Footer -->
    <footer class="bg-white border-top p-3 text-muted small">
        <div class="container">
        <div class="row align-items-center justify-content-between">
            <div>
                <a href="#" class="text-muted navbar-brand mr-2 mb-0">
                  <strong>Wechaty</strong>
                </a>
                <span>Copyright © <script>document.write(new Date().getFullYear())</script></span>
                |
                <a
                  class="text-muted"
                  target="_blank"
                  href="/branding/"
                >
                  Branding
                </a>

                <!--  Github Repo Star Btn-->
                <a class="text-dark ml-1" target="_blank" href="https://github.com/wechaty"><i class="fab fa-github"></i> </a>

            </div>

            <div class="text-gray">
              Powered by
              <a
                class="text-gray font-weight-bold"
                target="_blank"
                href="https://www.wowthemes.net/mundana-jekyll-theme/"
              >
                Mundana Jekyll Theme
              </a>
              .
            </div>
        </div>
        </div>
    </footer>

    <!-- All this area goes before             <script>
                window.onload = function () {
                    var script = document.createElement('script');
                    var firstScript = document.getElementsByTagName('script')[0];
                    script.type = 'text/javascript';
                    script.async = true;
                    script.src = '/sw-register.js?v=' + Date.now();
                    firstScript.parentNode.insertBefore(script, firstScript);
                };
            </script>
            </body>
 closing tag -->


</body>

</html>
